<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <title>Animancer - 06-04 Weapons</title>
        <link href="/animancer/assets/css/highlight.css" rel="stylesheet">
        <link href="/animancer/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/animancer/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/animancer/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/animancer/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/animancer/assets/css/override.css" rel="stylesheet">
        <script src="/animancer/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/animancer/assets/js/bootstrap.min.js"></script>        
        <script src="/animancer/assets/js/app.min.js"></script>         
        <script src="/animancer/assets/js/highlight.pack.js"></script>   
        <script src="/animancer/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/animancer/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/animancer/assets/js/mermaid.min.js"></script>
        <script src="/animancer/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/animancer/assets/js/html5shiv.min.js"></script>
        <script src="/animancer/assets/js/respond.min.js"></script>
        <![endif]-->  

        
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/animancer/" class="logo">
                            <span>Animancer</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li><a href="/animancer/docs/introduction/features"><img src="/animancer/images/features.png" height="20px" width="20px" style="left:-7px"> Features</a></li>
        <li><a href="/animancer/docs/download"><img src="/animancer/images/download.png" height="20px" width="20px" style="left:-7px"> Download</a></li>
        <li class="active"><a href="/animancer/docs"><img src="/animancer/images/docs.png" height="20px" width="7.5px" style="left:-5px"> Documentation</a></li>
        <li><a href="/animancer/docs/help"><img src="/animancer/images/help.png" height="20px" width="10.625px" style="left:-4px"> Help</a></li>
        <li><a href="/animancer/api/Animancer/AnimancerComponent"><img src="/animancer/images/api.png" height="20px" width="18.125px" style="left:-3px"> API v7.3</a></li>
        <li><a href="https://kybernetik.com.au"><img src="/animancer/images/kybernetik.png" height="20px" width="20px" style="left:-2px"> Other Assets</a></li>

<li style="width:100%">
<form class="search-form" name="search" action="/animancer/search">
<span><input class="search-input" id="search" name="q" type="text" placeholder="Search..."></span>
<div class="search-button"><button type="submit"><i class="fa fa-search"></i></button></div>
</form>
</li> 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#summary">Summary</a></p>
<p><a href="#controls">Controls</a></p>
<p><a href="#licensing">Licensing</a></p>
<p><a href="#overview">Overview</a></p>
<p><a href="#weapon">Weapon</a></p>
<p><a href="#weapon-prefabs">Weapon Prefabs</a></p>
<p><a href="#equipment">Equipment</a></p>
<p><a href="#equip-state">Equip State</a></p>
<p><a href="#attack-state">Attack State</a></p>
<p><a href="#weapons-character-brain">Weapons Character Brain</a></p>
<p><a href="#what-next">What Next?</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li><a href="/animancer/docs/download">Download</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction">Introduction</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/features">Features</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer">Mecanim vs. Animancer</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/why">Why Replace Mecanim?</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/simplicity">Simplicity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/transparency">Transparency</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/adaptability">Adaptability</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/clarity">Clarity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/safety">Safety</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/reliability">Reliability</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison">Comparison</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/playing">Playing</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/waiting">Waiting</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/speed-and-time">Speed and Time</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/weapon-animations">Weapon Animations</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/conversion">Conversion</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/performance">Performance</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/glossary">Glossary</a></li>
                <li><a href="/animancer/docs/introduction/cs">C# in Unity</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/examples">Examples</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/examples/basics">01 Basics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/basics/quick-play">01-01 Quick Play</a></li>
                <li><a href="/animancer/docs/examples/basics/movement">01-02 Basic Movement</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/basics/action">01-03 Basic Action</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/basics/action/holding">Holding a Pistol</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/basics/transitions">01-04 Transitions</a></li>
                <li><a href="/animancer/docs/examples/basics/character">01-05 Basic Character</a></li>
                <li><a href="/animancer/docs/examples/basics/scene-setup">Basic Scene Setup</a></li>
                <li><a href="/animancer/docs/examples/basics/input">Input</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/fine-control">02 Fine Control</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/fine-control/named-animations">02-01 Named Animations</a></li>
                <li><a href="/animancer/docs/examples/fine-control/speed-and-time">02-02 Speed and Time</a></li>
                <li><a href="/animancer/docs/examples/fine-control/doors">02-03 Doors</a></li>
                <li><a href="/animancer/docs/examples/fine-control/update-rate">02-04 Update Rate</a></li>
                <li><a href="/animancer/docs/examples/fine-control/solo-animation">02-05 Solo Animation</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/locomotion">03 Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/locomotion/root-motion">03-01 Root Motion</a></li>
                <li><a href="/animancer/docs/examples/locomotion/linear-blending">03-02 Linear Blending</a></li>
                <li><a href="/animancer/docs/examples/locomotion/directional-blending">03-03 Directional Blending</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/directional-sprites">04 Directional Sprites</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/directional-sprites/basics">04-01 Directional Basics</a></li>
                <li><a href="/animancer/docs/examples/directional-sprites/character">04-02 Directional Character</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/events">05 Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/events/footsteps">05-01 Footstep Events</a></li>
                <li><a href="/animancer/docs/examples/events/golf">05-02 Golf Events</a></li>
                <li><a href="/animancer/docs/examples/events/utilities">05-03 Event Utilities</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/examples/fsm">06 State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/fsm/characters">06-01 Characters</a></li>
                <li><a href="/animancer/docs/examples/fsm/interruptions">06-02 Interruptions</a></li>
                <li><a href="/animancer/docs/examples/fsm/brains">06-03 Brains</a></li>
                <li class="selected"><a href="/animancer/docs/examples/fsm/weapons">06-04 Weapons</a></li>
                <li><a href="/animancer/docs/examples/fsm/platformer">Platformer Game Kit</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/layers">07 Layers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/layers/basic">07-01 Basic Layers</a></li>
                <li><a href="/animancer/docs/examples/layers/dynamic">07-02 Dynamic Layers</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/ik">08 Inverse Kinematics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/ik/puppet">08-01 Puppet</a></li>
                <li><a href="/animancer/docs/examples/ik/uneven-ground">08-02 Uneven Ground</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers">09 Animator Controllers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/basics">09-01 Hybrid Basics</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/character">09-02 Hybrid Character</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers/3d-game-kit">09-03 3D Game Kit</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/problems">Problems with the Mecanim Character</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/respawn">Respawn</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/idle">Idle</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion">Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion/movement">Movement</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion/turning">Turning</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/airborne">Airborne</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/landing">Landing</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/attack">Attack</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/flinch">Flinch</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/die">Die</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/jobs">10 Animation Jobs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/jobs/two-bone-ik">10-01 Two Bone IK</a></li>
                <li><a href="/animancer/docs/examples/jobs/damping">10-02 Damping</a></li>
                <li><a href="/animancer/docs/examples/jobs/lean">10-03 Lean</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/integration">Integration</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/integration/animation-rigging">Animation Rigging</a></li>
                <li><a href="/animancer/docs/examples/integration/dynamic-bone">Dynamic Bone</a></li>
                <li><a href="/animancer/docs/examples/integration/final-ik">Final IK</a></li>
                <li><a href="/animancer/docs/examples/integration/hairibar-ragdoll">Hairibar Ragdoll</a></li>
                <li><a href="/animancer/docs/examples/integration/lod">Level of Detail (LOD)</a></li>
                <li><a href="/animancer/docs/examples/integration/odin-inspector">Odin Inspector</a></li>
                <li><a href="/animancer/docs/examples/integration/puppet-master">Puppet Master</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/no-video-tutorials">No Video Tutorials</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual">User Manual</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/manual/getting">Getting Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/getting/mixamo">Mixamo</a></li>
                <li><a href="/animancer/docs/manual/getting/importing">Importing</a></li>
                <li><a href="/animancer/docs/manual/getting/animation-window">Animation Window</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/playing">Playing Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/playing/states">States</a></li>
                <li><a href="/animancer/docs/manual/playing/keys">Keys</a></li>
                <li><a href="/animancer/docs/manual/playing/inspector">Inspector</a></li>
                <li><a href="/animancer/docs/manual/playing/component-types">Component Types</a></li>
                <li><a href="/animancer/docs/manual/playing/edit-mode">Playing in Edit Mode</a></li>
                <li><a href="/animancer/docs/manual/playing/directional-sets">Directional Animation Sets</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/transitions">Transitions</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/transitions/types">Transition Types</a></li>
                <li><a href="/animancer/docs/manual/transitions/assets">Transition Assets</a></li>
                <li><a href="/animancer/docs/manual/transitions/previews">Transition Previews</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending">Blending</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending/fading">Fading</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/blending/fading/modes">Fade Modes</a></li>
                <li><a href="/animancer/docs/manual/blending/fading/custom">Custom Fading</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/blending/layers">Layers</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending/mixers">Mixers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/blending/mixers/creation">Mixer Creation</a></li>
                <li><a href="/animancer/docs/manual/blending/mixers/smoothing">Mixer Smoothing</a></li>
                <li><a href="/animancer/docs/manual/blending/mixers/synchronization">Mixer Synchronization</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/events">Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/events/animation">Animation Events</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/events/animancer">Animancer Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/events/animancer/usage">Usage</a></li>
                <li><a href="/animancer/docs/manual/events/animancer/behaviour">Behaviour</a></li>
                <li><a href="/animancer/docs/manual/events/animancer/shared">Shared Events</a></li>
                <li><a href="/animancer/docs/manual/events/animancer/garbage">Garbage Collection</a></li>
                <li><a href="/animancer/docs/manual/events/animancer/ultevents">UltEvents</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/events/end">End Events</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/fsm">Finite State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/fsm/overview">Overview</a></li>
                <li><a href="/animancer/docs/manual/fsm/state-types">1. State Types</a></li>
                <li><a href="/animancer/docs/manual/fsm/initialization">2. Initialization</a></li>
                <li><a href="/animancer/docs/manual/fsm/changing-states">3. Changing States</a></li>
                <li><a href="/animancer/docs/manual/fsm/keys">Keys</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/fsm/utilities">Utilities</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/fsm/utilities/input-buffer">Input Buffers</a></li>
                <li><a href="/animancer/docs/manual/fsm/utilities/state-selector">State Selectors</a></li>
                <li><a href="/animancer/docs/manual/fsm/utilities/owned-states">Owned States</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/animator-controllers">Animator Controllers</a></li>
                <li><a href="/animancer/docs/manual/timeline">Timeline</a></li>
                <li><a href="/animancer/docs/manual/ik">Inverse Kinematics</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/tools">Animancer Tools</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/tools/pack-textures">Pack Textures</a></li>
                <li><a href="/animancer/docs/manual/tools/modify-sprites">Modify Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/rename-sprites">Rename Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/generate-sprite-animations">Generate Sprite Animations</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-sprite-animation">Remap Sprite Animation</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-animation-bindings">Remap Animation Bindings</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/other">Other Features</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/other/animation-clip-inspector">Animation Clip Inspector</a></li>
                <li><a href="/animancer/docs/manual/other/polymorphic">Polymorphic Drawer</a></li>
                <li><a href="/animancer/docs/manual/other/sprite-renderer-texture-swap">Sprite Renderer Texture Swap</a></li>
                <li><a href="/animancer/docs/manual/other/units">Units Attributes</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/bugs">Unity Bugs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/bugs/events">Animation Events</a></li>
                <li><a href="/animancer/docs/bugs/animator-controller-speed">Animator Controller Speed</a></li>
                <li><a href="/animancer/docs/bugs/paused-skinned-mesh-update">Paused Skinned Mesh Update</a></li>
                <li><a href="/animancer/docs/bugs/reorderable-array-height">Reorderable Array Height</a></li>
                <li><a href="/animancer/docs/bugs/serialized-array-initialization">Serialized Array Initialization</a></li>
                <li><a href="/animancer/docs/bugs/stabilize-feet">Stabilize Feet</a></li>
                <li><a href="/animancer/docs/bugs/timeline">Timeline</a></li>
                <li><a href="/animancer/docs/bugs/timing">Timing</a></li>
                <li><a href="/animancer/docs/bugs/update-modes">Update Modes</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/source">Source Code</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/source/dlls">DLLs</a></li>
                <li><a href="/animancer/docs/source/creating-custom-states">Creating Custom States</a></li>
                <li><a href="/animancer/docs/source/graph-structure">Graph Structure</a></li>
                <li><a href="/animancer/docs/source/asset-sources">Asset Sources</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/changes">Change Log</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v7-3">Animancer v7.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v7-2">Animancer v7.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v7-1">Animancer v7.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v7-0">Animancer v7.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v6-1">Animancer v6.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v6-0">Animancer v6.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v6-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v5-3">Animancer v5.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-2">Animancer v5.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-1">Animancer v5.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v5-0">Animancer v5.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v5-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v4-4">Animancer v4.4</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-3">Animancer v4.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-2">Animancer v4.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-1">Animancer v4.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v4-0">Animancer v4.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v4-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v3-1">Animancer v3.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v3-0">Animancer v3.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v2-0">Animancer v2.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-3">Animancer v1.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-2">Animancer v1.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-1">Animancer v1.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-0">Animancer v1.0</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/help">Help and FAQ</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/help/debugging">Debugging</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>06-04 Weapons</h1>
		</section>
	<section class="content">
		<blockquote class="blockquote">
<p><i class="emw fa fa-folder"></i> <strong>Location</strong>: <em><span class="mini">Assets/Plugins/Animancer/</span>Examples/06 State Machines/04 Weapons</em></p>
<p><i class="emw fa fa-code-fork"></i> <strong>Recommended After</strong>: <a href="../brains">Brains</a></p>
<p><i class="emw fa fa-puzzle-piece"></i> <strong>Learning Outcomes</strong>: <span class="mini">in this example you will learn:</span></p>
<p><i class="emw fa fa-lightbulb-o"></i> How to allow a character to equip different weapons.</p>
<p><i class="emw fa fa-lightbulb-o"></i> How have each weapon define its own animation details for the character to use.</p>
<p><i class="emw fa fa-lightbulb-o"></i> How to use <code>StateMachine&lt;T&gt;.InputBuffer</code>s.</p>
<p><i class="emw fa fa-lightbulb-o"></i> How to disable an <code>OptionalWarning</code> when you understand the risks it's warning about.</p>
</blockquote>
<img src="weapons-mixamo.png" class="pngif img-responsive img-right">
<img src="weapons.png" class="pngif img-responsive img-right" style="padding-top:1em">
<p>This example expands upon the <a href="../brains">Brains</a> example to allow a character hold various items and get their animations from those items so each one can have different animations. It only uses this system for <em>Attack</em>, <em>Equip</em>, and <em>UnEquip</em> animations, but the concept could be extended to other animations such as having a different <em>Idle</em> or <em>Walk</em> animation to hold the weapon correctly.</p>
<h1 id="summary">Summary</h1>
<ul>
<li>Animancer doesn't know or care where your animations are defined, so there's no need for all of them to be defined on the character.</li>
<li>In this case, a weapon prefab holds the animations that a character will use when they equip it.</li>
<li><a href="../../../manual/fsm/utilities/input-buffer">Input Buffering</a> can help make a game feel more responsive to the player by accepting button presses that were slightly too early for the corresponding actions to be performed.</li>
</ul>
<h1 id="controls">Controls</h1>
<ul>
<li>WASD = Move</li>
<li>Left Shift = Run</li>
<li>Left Click = Attack</li>
<li>Right Click = Change Weapon</li>
</ul>
<h1 id="licensing">Licensing</h1>
<p>The top video was made using the scripts from this example on a character called <em>Paladin J Nordstrom</em> from <a href="../../../manual/getting/mixamo">Mixamo</a> along with various animations. Unfortunately, those assets <a href="https://community.adobe.com/t5/fuse-beta/licensing-royalties-ownership-eula-and-tos-q-a/td-p/7676380">can't be legally redistributed in their raw source form</a>, meaning that they can't be included in Animancer. So instead, the actual example scene reuses the props and animations from earlier examples. This also avoids needing a large number of animations which would only be used in this one example.</p>
<h1 id="overview">Overview</h1>
<p>The general code structure is similar to the <a href="../brains">Brains</a> example, with a few changes:</p>
<ul>
<li><code>MovingCharacterBrain</code> has been replaced by <code>WeaponsCharacterBrain</code>.</li>
<li><code>ActionState</code> has been replaced by <code>EquipState</code> and <code>AttackState</code> which don't reference their animations directly. Instead, they get their animations from the currently equipped <code>Weapon</code>.</li>
</ul>
<p><img src="architecture.png" class="img-responsive" id="architecture"></p>
<p></p><details><summary>Click here to show the code structure from the <a href="../brains">Brains</a> example:</summary>
<p><img src="../brains/architecture.png" class="img-responsive"></p>
</details><p></p>
<h1 id="weapon">Weapon</h1>
<p>The main purpose of this example is to demonstrate how animations can be defined separately from a character. That's what the <code>Weapon</code> class is for, it holds the animations relating to a particular weapon so that when a character equips it they can play appropriate animations for it:</p>
<pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class Weapon : MonoBehaviour
{
</code></pre>
<p>It has an array of animations for the <a href="#attack-state">Attack State</a> to use in sequence if the character attacks repeatedly:</p>
<pre><code class="language-cs">    [SerializeField]
    private ClipTransition[] _AttackAnimations;
    public ClipTransition[] AttackAnimations =&gt; _AttackAnimations;
</code></pre>
<p>And animations for the <a href="#equip-state">Equip State</a> to use when changing to this weapon and before changing to another weapon:</p>
<pre><code class="language-cs">    [SerializeField]
    private ClipTransition _EquipAnimation;
    public ClipTransition EquipAnimation =&gt; _EquipAnimation;

    [SerializeField]
    private ClipTransition _UnequipAnimation;
    public ClipTransition UnequipAnimation =&gt; _UnequipAnimation;
}
</code></pre>
<p>In a real game, this class might have other details like damage, damage type, weapon category, etc. It could also <a href="/cs-unity/docs/introduction/inheritance">Inherit</a> from a base Item class for things like weight, cost, and description.</p>
<h1 id="weapon-prefabs">Weapon Prefabs</h1>
<p>Implementing <code>Weapon</code> as a component means that each one can be set up along with its model as a prefab. This offers great flexibility in how they can be used, such as to have a character pick up or drop a weapon or to dynamically load individual weapons when they are needed instead of directly referencing all available weapons at once (which would mean they are all loaded at all times).</p>
<p>But all that is beyond the scope of this example. Here we're just showing how animations can be defined outside of the logical state that uses them so the weapons are just objects in the scene and the <a href="#brain">Weapons Character Brain</a> references them all in an array:</p>
<p><img src="weapon-hierarchy.png" class="img-responsive"></p>
<h2 id="animancer-weapons">Animancer Weapons</h2>
<p>The weapons in the example scene are a bit limited because they're only reusing assets from other examples. They all use <em>Humanoid-Flinch</em> as their <code>Equip Animation</code> and have no <code>Unequip Animation</code>.</p>
<p></p><details><summary><em>Unarmed</em> doesn't have any attacks:</summary>
<p><img src="animancer-unarmed-inspector.png" class="img-responsive"></p>
<p><img src="animancer-unarmed.png" class="pngif img-responsive"></p>
</details><p></p>
<p></p><details><summary><em>Pistol</em> has one attack using <em>Humanoid-PistolShoot</em>:</summary>
<p><img src="animancer-pistol-inspector.png" class="img-responsive"></p>
<p><img src="animancer-pistol.png" class="pngif img-responsive"></p>
</details><p></p>
<p></p><details><summary><em>Golf Club</em> has an attack using <em>Humanoid-GolfSwing</em> then <em>Humanoid-PistolShoot</em> (it looks silly, but it at least shows how one attack animation chains into the next if you attack repeatedly):</summary>
<p><img src="animancer-golf-club-inspector.png" class="img-responsive"></p>
<p><img src="animancer-golf-club.png" class="pngif img-responsive"></p>
</details><p></p>
<h2 id="mixamo-weapons">Mixamo Weapons</h2>
<p>The <a href="../../../manual/getting/mixamo">Mixamo</a> weapons used for the first video are a bit more detailed.</p>
<p></p><details><summary><em>Unarmed</em> has two attacks but no equip or unequip animation:</summary>
<p><img src="mixamo-unarmed-inspector.png" class="img-responsive"></p>
<p><img src="mixamo-unarmed.png" class="pngif img-responsive"></p>
</details><p></p>
<p></p><details><summary><em>Club</em> has three attacks and one animation for both equip and unequip:</summary>
<p><img src="mixamo-club-inspector.png" class="img-responsive"></p>
<p><img src="mixamo-club.png" class="pngif img-responsive"></p>
</details><p></p>
<p></p><details><summary><em>Great Sword</em> has three attacks and separate animations for equip and unequip:</summary>
<p><img src="mixamo-great-sword-inspector.png" class="img-responsive"></p>
<p><img src="mixamo-great-sword.png" class="pngif img-responsive"></p>
</details><p></p>
<h1 id="equipment">Equipment</h1>
<p>The <code>Character</code> class has a reference to an <code>Equipment</code> component:</p>
<pre><code class="language-cs">class Character
{
    ...

    [SerializeField]
    private Equipment _Equipment;
    public Equipment Equipment =&gt; _Equipment;
}
</code></pre>
<p>The <a href="../../basics/action/holding">Holding a Pistol</a> page explains how to put an object in the character's hand. This example does the same thing in the <code>Equipment</code> script by giving it a reference to the <code>Transform</code> of the <em>RightHandHolder</em> bone so it can re-parent weapons to that bone when they are equipped:</p>
<pre><code class="language-cs">public sealed class Equipment : MonoBehaviour
{
    [SerializeField] private Transform _WeaponHolder;
</code></pre>
<p><img src="equipment-inspector.png" class="img-responsive"></p>
<p>It also has a reference to the currently equipped <code>Weapon</code> with a <code>public</code> wrapper property:</p>
<pre><code class="language-cs">    [SerializeField] private Weapon _Weapon;

    public Weapon Weapon
    {
        get =&gt; _Weapon;
</code></pre>
<p>When the <code>Weapon</code> is changed, it detaches the old weapon from the <code>_WeaponHolder</code> and attaches the new one to it:</p>
<pre><code class="language-cs">        set
        {
            DetachWeapon();
            _Weapon = value;
            AttachWeapon();
        }
    }
</code></pre>
<p>And it also needs to attach the current weapon on startup:</p>
<pre><code class="language-cs">    private void Awake()
    {
        AttachWeapon();
    }
</code></pre>
<p>Attaching a weapon involves setting the <code>_WeaponHolder</code> as its <code>parent</code>, clearing its local <code>Transform</code> values, and activating its <code>GameObject</code>:</p>
<pre><code class="language-cs">    private void AttachWeapon()
    {
        if (_Weapon == null)
            return;

        var transform = _Weapon.transform;
        transform.parent = _WeaponHolder;
        transform.localPosition = Vector3.zero;
        transform.localRotation = Quaternion.identity;
        transform.localScale = Vector3.one;

        _Weapon.gameObject.SetActive(true);
    }
</code></pre>
<p>And detaching a weapon is even simpler, it just sets this <code>Equipment</code> script's <code>Transform</code> as its <code>parent</code> and deactivates its <code>GameObject</code>:</p>
<pre><code class="language-cs">    private void DetachWeapon()
    {
        if (_Weapon == null)
            return;

        _Weapon.transform.parent = transform;
        _Weapon.gameObject.SetActive(false);
    }
}
</code></pre>
<p>In a real game, attaching and detaching a weapon might involve instantiating and destroying a prefab or leaving it active in the scene.</p>
<h1 id="equip-state">Equip State</h1>
<p></p><details><summary>The <code>EquipState</code> script is a bit more complex than the states in earlier examples because it handles both the unequipping and equipping animations:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using System;
using UnityEngine;

public sealed class EquipState : CharacterState
{
    private Action _OnUnequipEnd;

    public Weapon NextWeapon { get; set; }

    public Weapon CurrentWeapon =&gt; Character.Equipment.Weapon;

    private void Awake()
    {
        _OnUnequipEnd = OnUnequipEnd;
        NextWeapon = CurrentWeapon;

        OptionalWarning.LockedEvents.Disable();
    }

    public override bool CanEnterState =&gt;
        !enabled &amp;&amp;
        NextWeapon != CurrentWeapon;

    private void OnEnable()
    {
        if (CurrentWeapon.UnequipAnimation.IsValid)
        {
            var state = Character.Animancer.Play(CurrentWeapon.UnequipAnimation);
            state.Events.OnEnd = _OnUnequipEnd;
        }
        else
        {
            OnUnequipEnd();
        }
    }

    private void OnUnequipEnd()
    {
        Character.Equipment.Weapon = NextWeapon;

        if (CurrentWeapon.EquipAnimation.IsValid)
        {
            var state = Character.Animancer.Play(CurrentWeapon.EquipAnimation);
            state.Events.OnEnd = Character.StateMachine.ForceSetDefaultState;
        }
        else
        {
            Character.StateMachine.ForceSetDefaultState();
        }
    }

    public override CharacterStatePriority Priority =&gt; CharacterStatePriority.Medium;
}
</code></pre>
<p></p></details><p></p>
<p>It has two <code>Weapon</code>s:</p>
<ul>
<li>The <code>NextWeapon</code> needs to be set by whatever script tries to enter this state (in this example, that's the <a href="#weapons-character-brain">Brain</a>).</li>
<li>The <code>CurrentWeapon</code> is just a shortcut to get the current weapon from the <code>Equipment</code> script since it will be used several times throughout this script.</li>
</ul>
<pre><code class="language-cs">public Weapon NextWeapon { get; set; }

public Weapon CurrentWeapon =&gt; Character.Equipment.Weapon;

private void Awake()
{
    ...
    NextWeapon = CurrentWeapon;
    ...
</code></pre>
<p>This state can only be entered if it isn't already in progress (it can't interrupt itself) and if the <code>NextWeapon</code> has been set to something different from the <code>CurrentWeapon</code>:</p>
<pre><code class="language-cs">public override bool CanEnterState =&gt;
    !enabled &amp;&amp;
    NextWeapon != CurrentWeapon;
</code></pre>
<p>When this state plays an <code>UnequipAnimation</code>, it will use an <a href="../../../manual/events/end">End Event</a> to change the current weapon. The <a href="../../../manual/events/animancer/garbage">Garbage Collection</a> page explains how to avoid a potential performance issue when using events, which is to store the callback you want to use in a field so that its delegate doesn't need to be re-allocated every time you use it:</p>
<pre><code class="language-cs">private Action _OnUnequipEnd;

private void Awake()
{
    _OnUnequipEnd = OnUnequipEnd;

    ...
}

private void OnUnequipEnd() { ... }// Explained below.
</code></pre>
<p>In this example we assign <a href="../../../manual/events/end">End Event</a> to the weapon's animations each time they're used. In most situations, events on a transition should be set only once on startup because any changes will modify the transition's events cumulatively. Animancer would log a warning about that because it's a common source of bugs, but in this example we know what we're doing so we just disable the warning:</p>
<pre><code class="language-cs">private void Awake()
{
    ...
    OptionalWarning.LockedEvents.Disable();
}
</code></pre>
<p>When entering this state, if the <code>CurrentWeapon</code> (the previously equipped weapon) has a valid <code>UnequipAnimation</code>, play it and tell it to use the cached event, but if there is no animation just pretend it ended immediately:</p>
<pre><code class="language-cs">private void OnEnable()
{
    if (CurrentWeapon.UnequipAnimation.IsValid)
    {
        var state = Character.Animancer.Play(CurrentWeapon.UnequipAnimation);
        state.Events.OnEnd = _OnUnequipEnd;
    }
    else
    {
        OnUnequipEnd();
    }
}
</code></pre>
<p>When the <code>UnequipAnimation</code> ends (or is skipped), change the actual equipped weapon then do basically the same as before with the new weapon's <code>EquipAnimation</code>. This time when the animation ends it will end this state with <code>ForceSetDefaultState</code> (which is already a cached delegate):</p>
<pre><code class="language-cs">private void OnUnequipEnd()
{
    Character.Equipment.Weapon = NextWeapon;

    if (CurrentWeapon.EquipAnimation.IsValid)
    {
        var state = Character.Animancer.Play(CurrentWeapon.EquipAnimation);
        state.Events.OnEnd = Character.StateMachine.ForceSetDefaultState;
    }
    else
    {
        Character.StateMachine.ForceSetDefaultState();
    }
}
</code></pre>
<p>And finally, this state has <code>Medium</code> priority to control what can <a href="../interruptions">Interrupt</a> it:</p>
<pre><code class="language-cs">public override CharacterStatePriority Priority =&gt; CharacterStatePriority.Medium;
</code></pre>
<h1 id="attack-state">Attack State</h1>
<p></p><details><summary>The <code>AttackState</code> script plays animations from current weapon's <code>AttackAnimations</code> array. When entered it starts with the first attack, but if re-entered while the previous attack is still fading out it plays the next attack in the array:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class AttackState : CharacterState
{
    private int _AttackIndex = int.MaxValue;

    public Weapon Weapon =&gt; Character.Equipment.Weapon;

    public override bool CanEnterState =&gt;
        Weapon != null &amp;&amp;
        Weapon.AttackAnimations.Length &gt; 0;

    private void OnEnable()
    {
        if (ShouldRestartCombo())
        {
            _AttackIndex = 0;
        }
        else
        {
            _AttackIndex++;
        }

        var animation = Weapon.AttackAnimations[_AttackIndex];
        animation.Events.OnEnd = Character.StateMachine.ForceSetDefaultState;

        Character.Animancer.Play(animation);
    }

    private bool ShouldRestartCombo()
    {
        var attackAnimations = Weapon.AttackAnimations;

        if (_AttackIndex &gt;= attackAnimations.Length - 1)
            return true;

        var state = attackAnimations[_AttackIndex].State;
        if (state == null ||
            state.Weight == 0)
            return true;

        return false;
    }

    public override CharacterStatePriority Priority =&gt; CharacterStatePriority.Medium;
}
</code></pre>
<p></p></details><p></p>
<p>This state uses a simple <code>int</code> to keep track of which attack it's up to in the array. Each time the state is entered it either restarts from 0 or increments to the index:</p>
<pre><code class="language-cs">private int _AttackIndex = int.MaxValue;

private void OnEnable()
{
    if (ShouldRestartCombo())
    {
        _AttackIndex = 0;
    }
    else
    {
        _AttackIndex++;
    }

    ...
}
</code></pre>
<p>There are two things that will cause it to restart:</p>
<ul>
<li>If the index is already at the last animation.</li>
<li>Or if the previous animation has already faded out fully (or hasn't been initialized yet).</li>
</ul>
<pre><code class="language-cs">private bool ShouldRestartCombo()
{
    var attackAnimations = _Equipment.Weapon.AttackAnimations;

    if (_AttackIndex &gt;= attackAnimations.Length - 1)
        return true;

    var state = attackAnimations[_AttackIndex].State;
    if (state == null ||
        state.Weight == 0)
        return true;

    return false;
}
</code></pre>
<p>Once it knows which attack it's up to, it can simply play that animation and set itss <a href="../../../manual/events/end">End Event</a> to return to the default state (<em>Idle</em>):</p>
<pre><code class="language-cs">private void OnEnable()
{
    ...

    var animation = Weapon.AttackAnimations[_AttackIndex];
    animation.Events.OnEnd = Character.StateMachine.ForceSetDefaultState;

    Character.Animancer.Play(animation);
}
</code></pre>
<p>And just like with the <code>EquipState</code>, this state has <code>Medium</code> priority to control what can <a href="../interruptions">Interrupt</a> it:</p>
<pre><code class="language-cs">public override CharacterStatePriority Priority =&gt; CharacterStatePriority.Medium;
</code></pre>
<h1 id="weapons-character-brain">Weapons Character Brain</h1>
<p></p><details><summary>The <code>WeaponsCharacterBrain</code> script has the same movement code as <code>MovingCharacterBrain</code>, but has a few other additions:
<ul>
  <li>It uses an <code>InputBuffer</code> so that if a button is pressed before the corresponding state change is allowed, it will continue attempting the same state change for a short time.</li>
  <li>It references the <code>EquipState</code> to change the equipped weapon.</li>
  <li>It has an array of <code>Weapon</code>s to cycle through.</li>
</ul></summary><p>
</p><pre><code class="language-cs">using Animancer.FSM;
using Animancer.Units;
using System;
using UnityEngine;

public sealed class WeaponsCharacterBrain : MonoBehaviour
{
    [SerializeField] private Character _Character;
    [SerializeField] private CharacterState _Move;
    [SerializeField] private CharacterState _Attack;
    [SerializeField, Seconds] private float _InputTimeOut = 0.5f;
    [SerializeField] private EquipState _Equip;
    [SerializeField] private Weapon[] _Weapons;

    private StateMachine&lt;CharacterState&gt;.InputBuffer _InputBuffer;

    private void Awake()
    {
        _InputBuffer = new StateMachine&lt;CharacterState&gt;.InputBuffer(_Character.StateMachine);
    }

    private void Update()
    {
        UpdateMovement();
        UpdateEquip();
        UpdateAction();

        _InputBuffer.Update();
    }

    private void UpdateMovement()// This method is identical to the one in MovingCharacterBrain.
    {
        var input = ExampleInput.WASD;
        if (input != default)
        {
            // Get the camera's forward and right vectors and flatten them onto the XZ plane.
            var camera = Camera.main.transform;

            var forward = camera.forward;
            forward.y = 0;
            forward.Normalize();

            var right = camera.right;
            right.y = 0;
            right.Normalize();

            // Build the movement vector by multiplying the input by those axes.
            _Character.Parameters.MovementDirection =
                right * input.x +
                forward * input.y;

            // Enter the locomotion state if we aren't already in it.
            _Character.StateMachine.TrySetState(_Move);
        }
        else
        {
            _Character.Parameters.MovementDirection = default;
            _Character.StateMachine.TrySetDefaultState();
        }

        // Indicate whether the character wants to run or not.
        _Character.Parameters.WantsToRun = ExampleInput.LeftShiftHold;
    }

    private void UpdateEquip()
    {
        if (ExampleInput.RightMouseDown)
        {
            var equippedWeaponIndex = Array.IndexOf(_Weapons, _Character.Equipment.Weapon);

            equippedWeaponIndex++;
            if (equippedWeaponIndex &gt;= _Weapons.Length)
                equippedWeaponIndex = 0;

            _Equip.NextWeapon = _Weapons[equippedWeaponIndex];
            _InputBuffer.Buffer(_Equip, _InputTimeOut);
        }
    }

    private void UpdateAction()
    {
        if (ExampleInput.LeftMouseDown)
        {
            _InputBuffer.Buffer(_Attack, _InputTimeOut);
        }
    }
}
</code></pre>
<p></p></details><p></p>
<h2 id="input-buffering">Input Buffering</h2>
<p><a href="../../../manual/fsm/utilities/input-buffer">Input Buffering</a> is a technique where a failed state change is continually re-attempted after the initial input until it succeeds or a short timer elapses. This makes things easier for the player to control by giving them a larger window of time during which they can perform actions.</p>
<p>To use it in Animancer's <a href="../../../manual/fsm">Finite State Machine</a> system, you first initialize an <code>InputBuffer</code> with the <code>StateMachine</code> it will control:</p>
<pre><code class="language-cs">private StateMachine&lt;CharacterState&gt;.InputBuffer _InputBuffer;

private void Awake()
{
    _InputBuffer = new StateMachine&lt;CharacterState&gt;.InputBuffer(_Character.StateMachine);
}
</code></pre>
<p>To perform an action, call <code>Buffer</code> with the desired state and a "Time Out" value to determine how long the buffer will last (it could be hard coded, but being exposed in the Inspector makes it easy to tweak and test different values):</p>
<pre><code class="language-cs">[SerializeField, Seconds] private float _InputTimeOut = 0.5f;

private void UpdateAction()
{
    if (ExampleInput.LeftMouseDown)
    {
        _InputBuffer.Buffer(_Attack, _InputTimeOut);
    }
}
</code></pre>
<p>And finally, call <code>Update</code> on the buffer every time you want it to make another attempt to enter the state:</p>
<pre><code class="language-cs">private void Update()
{
    UpdateMovement();
    UpdateEquip();
    UpdateAction();

    _InputBuffer.Update();
}
</code></pre>
<h2 id="update-equip">Update Equip</h2>
<p>To equip the next weapon, it needs to first figure out which one is equipped:</p>
<pre><code class="language-cs">[SerializeField] private EquipState _Equip;
[SerializeField] private Weapon[] _Weapons;

private void UpdateEquip()
{
    if (ExampleInput.RightMouseDown)
    {
        var equippedWeaponIndex = Array.IndexOf(_Weapons, _Character.Equipment.Weapon);
</code></pre>
<p>This script could have a field to store the index, but the equipped weapon isn't actually changing here (only <strong>if</strong> the <code>EquipState</code> is entered and finishes playing the <code>UnequipAnimation</code>) so that could cause a mismatch between the stored value and the weapon that's actually equipped.</p>
<p>The index is incremented and if it goes past the last weapon in the array, it starts back at 0:</p>
<pre><code class="language-cs">        equippedWeaponIndex++;
        if (equippedWeaponIndex &gt;= _Weapons.Length)
            equippedWeaponIndex = 0;
</code></pre>
<p>Then it sets the <code>NextWeapon</code> and buffers the <code>EquipState</code> to try to equip that weapon:</p>
<pre><code class="language-cs">        _Equip.NextWeapon = _Weapons[equippedWeaponIndex];
        _InputBuffer.Buffer(_Equip, _InputTimeOut);
    }
}
</code></pre>
<p>If it fails to enter the <code>EquipState</code> or it gets interrupted, that <code>NextWeapon</code> will simply not get used and anything else that tries to enter the state should set its own value first.</p>
<h1 id="what-next">What Next?</h1>
<table class="table">
<thead>
<tr>
<th>Example</th>
<th>Topic</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/platformer">Platformer Game Kit</a></td>
<td>A separate (free) package which demonstrates a much more complete character implementation for a 2D platformer game.</td>
</tr>
<tr>
<td><a href="../../animator-controllers/3d-game-kit">3D Game Kit</a></td>
<td>A more complex character framework based on Unity's <a href="https://assetstore.unity.com/packages/templates/tutorials/3d-game-kit-lite-135162">3D Game Kit Lite</a>.</td>
</tr>
</tbody>
</table>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                <strong><div style="text-align:left; display:flex">

<div>
<p>Documentation</p>
<p><a href="/animancer/docs/examples">Examples</a></p>
<p><a href="/animancer/docs/manual">User Manual</a></p>
<p><a href="/animancer/docs/changes">Change Log</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Download</p>
<p><a href="https://kybernetik.itch.io/animancer-pro">Itch.io (Recommended)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-pro-116514?aid=1100l8ah5">Asset Store (Animancer Pro)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-lite-116516?aid=1100l8ah5">Asset Store (Animancer Lite)</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Contact</p>
<p><a href="https://github.com/KybernetikGames/animancer/issues">Github Issues</a></p>
<p><a href="/animancer/redirect/forum">Unity Forum</a></p>
<p><a href="mailto:animancer@kybernetik.com.au?subject=Animancer">Email</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Other Assets</p>
<p><a href="/inspector-gadgets">Inspector Gadgets</a></p>
<p><a href="/weaver">Weaver</a></p>
<p><a href="/ultevents">UltEvents</a></p>
</div>

</div></strong>
<script src="/animancer/assets/js/pngif.js"></script>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>