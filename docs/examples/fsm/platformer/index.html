<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <title>Animancer - 07 Platformer</title>
        <link href="/animancer/assets/css/highlight.css" rel="stylesheet">
        <link href="/animancer/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/animancer/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/animancer/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/animancer/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/animancer/assets/css/override.css" rel="stylesheet">
        <script src="/animancer/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/animancer/assets/js/bootstrap.min.js"></script>        
        <script src="/animancer/assets/js/app.min.js"></script>         
        <script src="/animancer/assets/js/highlight.pack.js"></script>   
        <script src="/animancer/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/animancer/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/animancer/assets/js/mermaid.min.js"></script>
        <script src="/animancer/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/animancer/assets/js/html5shiv.min.js"></script>
        <script src="/animancer/assets/js/respond.min.js"></script>
        <![endif]-->  

        
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/animancer/" class="logo">
                            <span>Animancer</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li><a href="/animancer/docs/introduction/features"><img src="/animancer/images/features.png" height="20px" width="20px" style="left:-7px"> Features</a></li>
        <li><a href="/animancer/docs/download"><img src="/animancer/images/download.png" height="20px" width="20px" style="left:-7px"> Download</a></li>
        <li class="active"><a href="/animancer/docs"><img src="/animancer/images/docs.png" height="20px" width="7.5px" style="left:-5px"> Documentation</a></li>
        <li><a href="/animancer/docs/help"><img src="/animancer/images/help.png" height="20px" width="10.625px" style="left:-4px"> Help</a></li>
        <li><a href="/animancer/api/Animancer/AnimancerComponent"><img src="/animancer/images/api.png" height="20px" width="18.125px" style="left:-3px"> API v6.1</a></li>
        <li><a href="/kailas-dierk/unity-assets"><img src="/animancer/images/kybernetik.png" height="20px" width="20px" style="left:-2px"> Other Assets</a></li>

<li style="width:100%">
<form class="search-form" name="search" action="/animancer/search">
<span><input class="search-input" id="search" name="q" type="text" placeholder="Search..."></span>
<div class="search-button"><button type="submit"><i class="fa fa-search"></i></button></div>
</form>
</li> 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#introductions">Introductions</a></p>
<p><a href="#idle">Idle</a></p>
<p><a href="#standardised-locomotion">Standardised Locomotion</a></p>
<p><a href="#ground-detector">Ground Detector</a></p>
<p><a href="#jumping">Jumping</a></p>
<p><a href="#life">Life</a></p>
<p><a href="#death">Death</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li><a href="/animancer/docs/download">Download</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction">Introduction</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/features">Features</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer">Mecanim vs. Animancer</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/why">Why Replace Mecanim?</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/simplicity">Simplicity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/transparency">Transparency</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/adaptability">Adaptability</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/clarity">Clarity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/safety">Safety</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/reliability">Reliability</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison">Comparison</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/playing">Playing</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/waiting">Waiting</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/speed-and-time">Speed and Time</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/weapon-animations">Weapon Animations</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/conversion">Conversion</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/performance">Performance</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/glossary">Glossary</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/cs">C# in Unity</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/cs/overview">Scripting Overview</a></li>
                <li><a href="/animancer/docs/introduction/cs/organisation">Organisation</a></li>
                <li><a href="/animancer/docs/introduction/cs/variables">Variables</a></li>
                <li><a href="/animancer/docs/introduction/cs/methods">Methods</a></li>
                <li><a href="/animancer/docs/introduction/cs/inheritance">Inheritance</a></li>
                <li><a href="/animancer/docs/introduction/cs/vectors">Vectors</a></li>
                <li><a href="/animancer/docs/introduction/cs/other">Other Topics</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/examples">Examples</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/examples/basics">01 Basics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/basics/scene-setup">Basic Scene Setup</a></li>
                <li><a href="/animancer/docs/examples/basics/quick-play">01 Quick Play</a></li>
                <li><a href="/animancer/docs/examples/basics/playing-and-fading">02 Playing and Fading</a></li>
                <li><a href="/animancer/docs/examples/basics/sequence-coroutine">03 Sequence Coroutine</a></li>
                <li><a href="/animancer/docs/examples/basics/named-animations">04 Named Animations</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/fine-control">02 Fine Control</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/fine-control/spider-bot">01 Spider Bot</a></li>
                <li><a href="/animancer/docs/examples/fine-control/doors">02 Doors</a></li>
                <li><a href="/animancer/docs/examples/fine-control/solo-animation">03 Solo Animation</a></li>
                <li><a href="/animancer/docs/examples/fine-control/update-rate">04 Update Rate</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/locomotion">03 Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/locomotion/walk-and-run">01 Walk and Run</a></li>
                <li><a href="/animancer/docs/examples/locomotion/root-motion">02 Root Motion</a></li>
                <li><a href="/animancer/docs/examples/locomotion/linear-blending">03 Linear Blending</a></li>
                <li><a href="/animancer/docs/examples/locomotion/directional-blending">04 Directional Blending</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/directional-sprites">04 Directional Sprites</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/directional-sprites/basic-movement">01 Basic Movement</a></li>
                <li><a href="/animancer/docs/examples/directional-sprites/character-controller">02 Character Controller</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/events">05 Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/events/footsteps">01 Footstep Events</a></li>
                <li><a href="/animancer/docs/examples/events/golf">02 Golf Events</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/examples/fsm">06 State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/examples/fsm/game-manager">01 Game Manager</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/fsm/game-manager/enum">Enum</a></li>
                <li><a href="/animancer/docs/examples/fsm/game-manager/fsm">FSM</a></li>
                <li><a href="/animancer/docs/examples/fsm/game-manager/comparison">Comparison</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/fsm/creatures">02 Creatures</a></li>
                <li><a href="/animancer/docs/examples/fsm/interrupts">03 Interrupt Management</a></li>
                <li><a href="/animancer/docs/examples/fsm/brains">04 Brains</a></li>
                <li><a href="/animancer/docs/examples/fsm/more-brains">05 More Brains</a></li>
                <li><a href="/animancer/docs/examples/fsm/weapons">06 Weapons</a></li>
                <li class="selected"><a href="/animancer/docs/examples/fsm/platformer">07 Platformer</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/layers">07 Layers</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/ik">08 Inverse Kinematics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/ik/puppet">01 Puppet</a></li>
                <li><a href="/animancer/docs/examples/ik/uneven-ground">02 Uneven Ground</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers">09 Animator Controllers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/basics">01 Hybrid Basics</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/mini-game">02 Hybrid Mini Game</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers/3d-game-kit">03 3D Game Kit</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/problems">Problems with the Mecanim Character</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/respawn">Respawn</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/idle">Idle</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion">Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion/movement">Movement</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion/turning">Turning</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/airborne">Airborne</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/landing">Landing</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/attack">Attack</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/flinch">Flinch</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/die">Die</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/jobs">10 Animation Jobs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/jobs/two-bone-ik">01 Two Bone IK</a></li>
                <li><a href="/animancer/docs/examples/jobs/damping">02 Damping</a></li>
                <li><a href="/animancer/docs/examples/jobs/lean">03 Lean</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/integration">Integration</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/integration/animation-rigging">Animation Rigging</a></li>
                <li><a href="/animancer/docs/examples/integration/dynamic-bone">Dynamic Bone</a></li>
                <li><a href="/animancer/docs/examples/integration/final-ik">Final IK</a></li>
                <li><a href="/animancer/docs/examples/integration/hairibar-ragdoll">Hairibar Ragdoll</a></li>
                <li><a href="/animancer/docs/examples/integration/puppet-master">Puppet Master</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/no-video-tutorials">No Video Tutorials</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual">User Manual</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/manual/getting">Getting Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/getting/mixamo">Mixamo</a></li>
                <li><a href="/animancer/docs/manual/getting/importing">Importing</a></li>
                <li><a href="/animancer/docs/manual/getting/animation-window">Animation Window</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/playing">Playing Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/playing/states">States</a></li>
                <li><a href="/animancer/docs/manual/playing/inspector">Inspector</a></li>
                <li><a href="/animancer/docs/manual/playing/component-types">Component Types</a></li>
                <li><a href="/animancer/docs/manual/playing/directional-sets">Directional Animation Sets</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/transitions">Transitions</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/transitions/types">Transition Types</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending">Blending</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/blending/fading">Fading</a></li>
                <li><a href="/animancer/docs/manual/blending/layers">Layers</a></li>
                <li><a href="/animancer/docs/manual/blending/mixers">Mixers</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/events">Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/events/animation">Animation Events</a></li>
                <li><a href="/animancer/docs/manual/events/animancer">Animancer Events</a></li>
                <li><a href="/animancer/docs/manual/events/end">End Events</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/fsm">Finite State Machines</a></li>
                <li><a href="/animancer/docs/manual/animator-controllers">Animator Controllers</a></li>
                <li><a href="/animancer/docs/manual/timeline">Timeline</a></li>
                <li><a href="/animancer/docs/manual/ik">Inverse Kinematics</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/tools">Animancer Tools</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/tools/pack-textures">Pack Textures</a></li>
                <li><a href="/animancer/docs/manual/tools/modify-sprites">Modify Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/rename-sprites">Rename Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/generate-sprite-animations">Generate Sprite Animations</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-sprite-animation">Remap Sprite Animation</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-animation-bindings">Remap Animation Bindings</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/bugs">Unity Bugs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/bugs/events">Animation Events</a></li>
                <li><a href="/animancer/docs/bugs/rigging-ik">Animation Rigging IK</a></li>
                <li><a href="/animancer/docs/bugs/animator-controller-speed">Animator Controller Speed</a></li>
                <li><a href="/animancer/docs/bugs/paused-skinned-mesh-update">Paused Skinned Mesh Update</a></li>
                <li><a href="/animancer/docs/bugs/serialized-array-initialization">Serialized Array Initialization</a></li>
                <li><a href="/animancer/docs/bugs/stabilize-feet">Stabilize Feet</a></li>
                <li><a href="/animancer/docs/bugs/timeline">Timeline</a></li>
                <li><a href="/animancer/docs/bugs/timing">Timing</a></li>
                <li><a href="/animancer/docs/bugs/update-modes">Update Modes</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/source">Source Code</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/source/dlls">DLLs</a></li>
                <li><a href="/animancer/docs/source/creating-custom-states">Creating Custom States</a></li>
                <li><a href="/animancer/docs/source/graph-structure">Graph Structure</a></li>
                <li><a href="/animancer/docs/source/asset-sources">Asset Sources</a></li>
                <li><a href="/animancer/docs/source/coding-standard">Coding Standard</a></li>
                <li><a href="/animancer/docs/source/default-script-template">Default Script Template</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/changes">Change Log</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v6-1">Animancer v6.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v6-0">Animancer v6.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v6-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v5-3">Animancer v5.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-2">Animancer v5.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-1">Animancer v5.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v5-0">Animancer v5.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v5-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v4-4">Animancer v4.4</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-3">Animancer v4.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-2">Animancer v4.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-1">Animancer v4.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v4-0">Animancer v4.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v4-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v3-1">Animancer v3.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v3-0">Animancer v3.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v2-0">Animancer v2.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-3">Animancer v1.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-2">Animancer v1.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-1">Animancer v1.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-0">Animancer v1.0</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/help">Help and FAQ</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/help/debugging">Debugging</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>07 Platformer</h1>
		</section>
	<section class="content">
		<blockquote class="blockquote">
<p><strong>Difficulty</strong>: <a href="../../../introduction/glossary#example-difficulty">Intermediate</a> - Recommended after <a href="../interrupts">Interrupt Management</a> and <a href="../brains">Brains</a></p>
<p><strong>Location</strong>: <em>Assets/Plugins/Animancer/Examples/06 State Machines/07 Platformer</em></p>
<p><strong>Namespace</strong>: <a href="../../../../api/Animancer.Examples.StateMachines.Platformer"><code>Animancer.Examples.StateMachines.Platformer</code></a></p>
</blockquote>
<p>This example demonstrates how the ideas from <a href="../creatures">Creatures</a> and <a href="../brains">Brains</a> can be used to make a character controller for a 2D platformer featuring:</p>
<ul>
<li>Using a <a href="../../../manual/timeline">Timeline Asset</a> to create an introduction sequence to play on startup.</li>
<li>Walking and running.</li>
<li>Jumping with the height determined by how long you hold the key.</li>
<li>Attacking (though there is no damage system or anything to attack).</li>
<li>Dying which prevents the player from controlling the character.</li>
</ul>
<p><em><a href="../../../introduction/features"><strong>Pro-Only Features</strong></a> are used in this example: <a href="../../../manual/timeline">Timeline Assets</a>. Animancer Lite allows you to try out these features in the Unity Editor, but they are not available in runtime builds unless you purchase <a href="/animancer/pro">Animancer Pro</a>.</em></p>
<p>Many of the concepts used in this example have already been explained in the earlier <a href="../">State Machines</a> examples so they will not be repeated here.</p>
<p></p><figure>
    <img src="platformer.gif" class="img-responsive">
    <figcaption><a href="https://opengameart.org/content/the-knight-free-sprite">Knight</a> created by pzUH - CC0 Licence.</figcaption>
</figure><p></p>
<p>Note that this video is a little different from the actual example scene. It has disabled the camera movement because the delta based compression used by GIFs is not effective when the entire image is moving (causing the video file to be far larger than any of the other examples). The sprites have also been significantly reduced in size from their originals to keep the package size of Animancer small.</p>
<h1 id="introductions">Introductions</h1>
<p>Many games play a special animation for the player when the scene starts which is not used again during regular gameplay. For example, Super Smash Bros. Ultimate:</p>
<iframe width="200" height="113" src="https://www.youtube.com/embed/XXZpGWfi-ak?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
<p>Those animations could simply be created as a single <code>AnimationClip</code> (per character) so that it can be played like any other, but Unity's <a href="../../../manual/timeline">Timeline</a> package allows us to create animation sequences from multiple clips within Unity and then play the entire sequence using a <code><a href="/animancer/api/Animancer/PlayableAssetState">PlayableAssetState</a></code> in Animancer. This example uses a simple sequence of 3 animations: <em>Knight-ExpandFromPoint</em> and <em>Knight-Flip</em> are only used in this sequence, then they are followed by the regular <em>Knight-Attack</em> which is used during gameplay.</p>
<p><img src="timeline.png" class="img-responsive"></p>
<p>We could instead give our script an array of <code>AnimationClip</code>s and play them in sequence like the <a href="../../basics/sequence-coroutine">Sequence Coroutine</a> example, but this way the artists have full control over the sequence and the code is very simple:</p>
<table class="table">
  <thead>
    <tr><th>Code</th>
    <th>Inspector</th>
  </tr></thead>
  <tbody>
    <tr>
      <td>
<pre><code class="language-cs">[SerializeField]
private&nbsp;<a href="/animancer/api/Animancer/Transition">PlayableAssetState.Transition</a>&nbsp;_Animation;

[SerializeField]
private bool _DestroyWhenDone;</code></pre>
</td>
      <td><img src="timeline-state.png" class="img-responsive"></td>
    </tr>
  </tbody>
</table>
<p>With those fields, we can play the <code>TimelineAsset</code> (which inherits from <code>PlayableAsset</code>) like any other <a href="../../../manual/transitions">Transition</a>:</p>
<pre><code class="language-cs">private void OnEnable()
{
    Creature.Animancer.Play(_Animation);
}
</code></pre>
<p>Since the sequence is only used once on startup, you might want to destroy it after it finishes. But since destroying it will create <a href="../../../introduction/cs/other#garbage-collection">Garbage</a>, you might want to just leave it there until the scene is unloaded. So we use a simple <code>_DestroyWhenDone</code> field to decide what to do and register an appropriate callback to the <a href="../../../manual/events/end">End Event</a> of the sequence:</p>
<pre><code class="language-cs">[SerializeField] private bool _DestroyWhenDone;

private void Awake()
{
    if (_DestroyWhenDone)
    {
        _Animation.Events.OnEnd = () =&gt;
        {
            Creature.Idle.ForceEnterState();

            // Destroy the <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> managing the sequence.
            Creature.Animancer.States.Destroy(_Animation);

            // Destroy this component as well.
            Destroy(this);
        };
    }
    else
    {
        _Animation.Events.OnEnd = Creature.ForceEnterIdleState;
    }
}
</code></pre>
<p></p><details><summary>The full <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/TimelineState">TimelineState</a></code> script looks like this:</summary><p>
</p><pre><code class="language-cs">public sealed class <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/TimelineState">TimelineState</a> : CreatureState
{
    [SerializeField] private <a href="/animancer/api/Animancer/Transition">PlayableAssetState.Transition</a> _Animation;
    [SerializeField] private bool _DestroyWhenDone;

    private void Awake()
    {
        if (_DestroyWhenDone)
        {
            _Animation.Events.OnEnd = () =&gt;
            {
                Creature.Idle.ForceEnterState();
                Creature.Animancer.States.Destroy(_Animation);
                Destroy(this);
            };
        }
        else
        {
            _Animation.Events.OnEnd = Creature.ForceEnterIdleState;
        }
    }

    private void OnEnable()
    {
        Creature.Animancer.Play(_Animation);
    }
}
</code></pre>
<p></p></details><p></p>
<h1 id="idle">Idle</h1>
<p>The <a href="../brains">Brains</a> example merged the <em>Walk</em> and <em>Run</em> animations into a single <code>LocomotionState</code> so that it could synchronise their timings, but kept that separate from the <code>IdleState</code>. This meant that in order to move, the brain had to set the <code>MovementDirection</code> and also attempt to enter the <code>LocomotionState</code>. It also meant that whenever a creature finished an action they returned to the <code>IdleState</code> at least momentarily, even if the brain was trying to move. We could have the <code>ReturnToIdle</code> callback determine which of those states to return to when an action finishes, but in this example we have merged them all into the <code>IdleState</code> so we are using the term "Idle" to mean "able to move freely" rather than specifically "standing still".</p>
<p>This means that the brain can just control the <code>MovementDirection</code> and <code>IsRunning</code> properties then a creature in the <code>IdleState</code> will act accordingly. A creature will never have a non-zero <code>MovementDirection</code> while standing still just because the brain forgot to enter the <code>LocomotionState</code>.</p>
<p></p><details><summary>This allows the <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/LocalPlayerBrain">LocalPlayerBrain</a></code> script to be quite simple (we will be changing it a bit to implement <a href="#jumping">Jumping</a> later):</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/LocalPlayerBrain">LocalPlayerBrain</a> : CreatureBrain
{
    [SerializeField] private CreatureState _Attack;

    private void Update()
    {
        if (Input.GetButtonUp("Fire1"))// Left Click by default.
            Creature.StateMachine.TrySetState(_Attack);

        // GetAxisRaw rather than GetAxis because we do not want any smoothing.
        MovementDirection = Input.GetAxisRaw("Horizontal");// A and D or Arrow Keys by default.

        IsRunning = Input.GetButton("Fire3");// Left Shift by default.
    }
}
</code></pre>
<p></p></details><p></p>
<h1 id="standardised-locomotion">Standardised Locomotion</h1>
<p>The <a href="../brains">Brains</a> example only had two states so they could each just implement their own locomotion, but in this example we have more states so we want them all to share the same locomotion system. We do this by giving the base <code>CreatureState</code> class a <a href="../../../introduction/cs/inheritance#keywords"><code>virtual</code></a> property which any state can <a href="../../../introduction/cs/inheritance#keywords"><code>override</code></a> to allow movement:</p>
<pre><code class="language-cs">// CreatureState does not allow movement by default:
public virtual float MovementSpeed =&gt; 0;

// IdleState uses either a run or walk speed:
public override float MovementSpeed =&gt; Creature.Brain.IsRunning ? _RunSpeed : _WalkSpeed;

// <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/JumpState">JumpState</a> uses whatever speed the Idle state recommends:
public override float MovementSpeed =&gt; Creature.Idle.MovementSpeed;

// Other states stick with the base 0 speed.
</code></pre>
<p>Then in the <code>Creature</code> class we apply that movement speed according to the brain's <code>MovementDirection</code> and the <code>MovementSpeed</code> of the current state:</p>
<pre><code class="language-cs">private void FixedUpdate()
{
    var speed = StateMachine.CurrentState.MovementSpeed * _Brain.MovementDirection;
    _Rigidbody.velocity = new Vector2(speed, _Rigidbody.velocity.y);

    // The sprites face right by default, so flip the X axis when moving left.
    if (speed != 0)
        _Renderer.flipX = _Brain.MovementDirection &lt; 0;
}
</code></pre>
<p>This means any state that wants to allow movement can specify its own speed (you might swim or fly at a different speed) and even states that do not allow movement will continue applying the same movement rules to prevent the character from sliding or being pushed around.</p>
<h1 id="ground-detector">Ground Detector</h1>
<p>Practically every game that involves jumping needs a way to determine whether a creature is actually on the ground or not at any given time. Many games use raycasts which start just above the creature's feet and travel a short distance downwards to determine if the ground is nearby, but for this example we use the physics contact points instead.</p>
<p>We start with some <a href="../../../introduction/cs/variables#serialized-fields">Serialized Fields</a> for the collider and grip angle, as well as a read-only <code>IsGrounded</code> <a href="../../../introduction/cs/methods#auto-properties">Auto-Property</a> so this script can set it and anything else can check the value but not change it:</p>
<pre><code class="language-cs">[SerializeField] private Collider2D _Collider;
[SerializeField] private float _GripAngle = 45;

public bool IsGrounded { get; private set; }
</code></pre>
<p>Then we pre-allocate an array of <code>ContactPoint2D</code> so that Unity does not need to allocate a new one (and thus create <a href="../../../introduction/cs/other#garbage-collection">Garbage</a> which is bad for performance) every time we get the contact points.</p>
<ul>
<li>We use a <code>static</code> field so that there is only one array which is shared by every instance of this script because we do not actually want to store the contents. We just get the values into the array, determine what to do based on them, then we do not care about them anymore so the next instance can reuse the same array.</li>
<li>Size 8 should be plenty of room for all the contact points a character could have at any given time, but in a real game this number might need to be a bit higher just in case.</li>
</ul>
<pre><code class="language-cs">private static readonly ContactPoint2D[] _Contacts = new ContactPoint2D[8];
</code></pre>
<p>Unity 2019.1 added an <a href="../../../introduction/cs/methods#overloads">Overload</a> of the <code>GetContacts</code> method which takes a <a href="../../../introduction/cs/variables#lists">List</a> parameter that it can automatically resize as necessary for the current number of contact points, but since Animancer still supports older Unity versions we still need to use the <a href="../../../introduction/cs/variables#arrays">Array</a> based methods.</p>
<p>In <code>FixedUpdate</code> we start by getting the current contact points:</p>
<pre><code class="language-cs">private void FixedUpdate()
{
    // A label for the goto statement to jump to.
    GetContacts:

    // Get the contacts.
    var contactCount = _Collider.GetContacts(_Contacts);

    // If the array is full, double its size, log a message, and go back to get the contacts again.
    if (contactCount &gt;= _Contacts.Length)
    {
        _Contacts = new ContactPoint2D[_Contacts.Length * 2];

        // If you see this message while testing, you should increase the starting size.
        Debug.LogWarning("_Contacts array is full. Increased size to " + _Contacts.Length);

        goto GetContacts;
    }
</code></pre>
<p>The <code>goto</code> statement is not needed very often in C#, but it can be useful in situations like this where a standard <code>for</code>, <code>while</code>, or <code>do while</code> loop isn't quite suitable for the job.</p>
<p>Once we have the contacts, we go through them all to see if any have a <code>normal</code> (the direction of the contact) which is close enough to straight up (according to our <code>_GripAngle</code> field):</p>
<pre><code class="language-cs">    for (int i = 0; i &lt; contactCount; i++)
    {
        // As long as one contact point has a normal close to straight up, we are grounded.
        var contact = _Contacts[i];
        if (Vector2.Angle(contact.normal, Vector2.up) &lt; _GripAngle)
        {
            IsGrounded = true;

            // We now know we are grounded so we can skip the rest of the contacts.
            return;
        }
    }
    
    IsGrounded = false;
}
</code></pre>
<p></p><details><summary>The full <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/GroundDetector">GroundDetector</a></code> script looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/GroundDetector">GroundDetector</a> : MonoBehaviour
{
    [SerializeField] private Collider2D _Collider;
    [SerializeField] private float _GripAngle = 45;

    public bool IsGrounded { get; private set; }

    private static ContactPoint2D[] _Contacts = new ContactPoint2D[8];

    private void FixedUpdate()
    {
        GetContacts:
        var contactCount = _Collider.GetContacts(_Contacts);

        if (contactCount &gt;= _Contacts.Length)
        {
            _Contacts = new ContactPoint2D[_Contacts.Length * 2];
            Debug.LogWarning("_Contacts array is full. Increased size to " + _Contacts.Length);
            goto GetContacts;
        }

        for (int i = 0; i &lt; contactCount; i++)
        {
            var contact = _Contacts[i];
            if (Vector2.Angle(contact.normal, Vector2.up) &lt; _GripAngle)
            {
                IsGrounded = true;
                return;
            }
        }

        IsGrounded = false;
    }
}
</code></pre>
<p></p></details><p></p>
<p>With that script in place, we can give the <code>Creature</code> script a reference to it with a <a href="../../../introduction/cs/methods#properties">Property</a> for other scripts to access it:</p>
<pre><code class="language-cs">[SerializeField]
private <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/GroundDetector">GroundDetector</a> _GroundDetector;
public <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/GroundDetector">GroundDetector</a> <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/GroundDetector">GroundDetector</a> =&gt; _GroundDetector;
</code></pre>
<p>Then anything can check if the creature is on the ground:</p>
<pre><code class="language-cs">// You can only jump while grounded:
public sealed class <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/JumpState">JumpState</a> : CreatureState
{
    public override bool CanEnterState =&gt; Creature.GroundDetector.IsGrounded;

    ...
}

// You use a different attack animation in the air:
public sealed class AttackState : CreatureState
{
    private void OnEnable()
    {
        var animation = Creature.GroundDetector.IsGrounded ? _GroundAnimation : _AirAnimation;
        var state = Creature.Animancer.Play(animation);
        state.OnEnd = Creature.ForceEnterIdleState;
    }

    ...
}
</code></pre>
<h1 id="jumping">Jumping</h1>
<p>The only part of jumping that we have not covered yet is the physics. A simple implementation would simply use a force value which can be adjusted in the Inspector to give the desired jump height:</p>
<pre><code class="language-cs">// In JumpState:
[SerializeField] private float _Force = 10;

private void OnEnable()
{
    Creature.Rigidbody.velocity += new Vector2(0, _Force);
}
</code></pre>
<p>But that is not the most convenient type of number for game designers to work with. Instead, we want to enter a desired jump height and calculate the necessary force to reach that height by taking into account the acceleration due to gravity. You can find many websites that explain the meths behind this sort of calculation so we will not explain it here, but it can be implemented like so:</p>
<pre><code class="language-cs">[SerializeField] private float _Height = 3;

private void OnEnable()
{
    Creature.Rigidbody.velocity += new Vector2(0, CalculateJumpSpeed(_Height));
}

public float CalculateJumpSpeed(float height)
{
    var gravity = Physics2D.gravity.y * Creature.Rigidbody.gravityScale;
    return Mathf.Sqrt(-2 * gravity * height);
}
</code></pre>
<p>This assumes gravity is negative (downwards), otherwise any force would give an infinite jump height.</p>
<p>If we wanted to support gravity in any direction, we could replace <code>Physics2D.gravity.y</code> with a <a href="../../../introduction/cs/vectors#dot-product">Dot Product</a>: <code>Vector2.Dot(Physics2D.gravity, Creature.transform.up)</code>. We could have just done that here, but it is a bit less efficient and we do not need the complexity.</p>
<p></p><details><summary>The full <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/GroundDetector">GroundDetector</a></code> script looks like this:</summary><p>
</p><pre><code class="language-cs">public class <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/JumpState">JumpState</a> : CreatureState
{
    [SerializeField] private AnimationClip _Animation;
    [SerializeField] private float _Height = 3;

    protected <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> { get; private set; }

    public override float MovementSpeed =&gt; Creature.Idle.MovementSpeed;

    public override bool CanEnterState =&gt; Creature.GroundDetector.IsGrounded;

    protected virtual void OnEnable()
    {
        Creature.Rigidbody.velocity += new Vector2(0, CalculateJumpSpeed(_Height));

        <a href="/animancer/api/Animancer/AnimancerState">AnimancerState</a> = Creature.Animancer.Play(_Animation);
    }

    protected virtual void FixedUpdate()
    {
        if (Creature.GroundDetector.IsGrounded &amp;&amp; <a href="/animancer/api/Animancer/AnimancerState/617EFC91">AnimancerState.NormalizedTime</a> &gt; 1)
            Creature.Idle.ForceEnterState();
    }

    public float CalculateJumpSpeed(float height)
    {
        var gravity = Physics2D.gravity.y * Creature.Rigidbody.gravityScale;
        return Mathf.Sqrt(-2 * gravity * height);
    }
}
</code></pre>
<p></p></details><p></p>
<h2 id="gravity">Gravity</h2>
<p>Gravity on Earth applies approximately 9.81 meters per second of acceleration every second (9.81 meters per second per second, or 9.81 m/s^2), but characters in games can often jump far higher than people in real life (can you jump more than twice your own height while wearing armour like the character in this example?). This means that applying the same gravity acceleration often allows characters to float in the air for far longer than we want. The solution is obviously to increase gravity which can be done in the project's Physics settings (or Physics 2D in this case), but you might also want different multipliers for each character and since we do not want to modify your project's settings just for this example we have simply set the <code>Gravity Scale</code> of the <code>Rigidbody2D</code> component to 2 (which we already accounted for in the jump height calculation above).</p>
<h2 id="variable-height">Variable Height</h2>
<p>Many games allow the player to do a small jump by quickly tapping the key or jump higher by holding it down for a bit. Common enemies do not usually make use of this mechanic though, so rather than modifying our <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/JumpState">JumpState</a></code> we are going to create another script which <a href="../../../introduction/cs/inheritance">Inherits</a> from it so players can use the new script while other creatures continue using the original <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/JumpState">JumpState</a></code> script (not that there are any other creatures in this example).</p>
<p>There are generally two ways to vary the jump height:</p>
<ul>
<li>Play a quick crouch animation before the jump and then choose whether to use the short or long jump height when the crouch finishes.</li>
<li>Apply some extra upwards acceleration for a short time at the start of the jump until the player releases the button. This is the approach we are using because we do not have a crouch animation for this character.</li>
</ul>
<p>Unfortunately, applying acceleration over time makes it much harder to calculate the extra force needed to increase the total height by a specific amount, so instead we are simply going to enter the force value directly and let it be adjusted in the Inspector:</p>
<pre><code class="language-cs">public sealed class <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/AdvancedJumpState">AdvancedJumpState</a> : <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/JumpState">JumpState</a>
{
    [SerializeField] private float _HoldForce = 20;
    [SerializeField] private float _HoldDuration = 0.25f;
</code></pre>
<p>If this script were to only ever be used for the player, we could directly check whether they are holding the button here. But in the interest of demonstrating good code architecture we will instead expose a <a href="../../../introduction/cs/organisation#access-modifiers"><code>public</code></a> <a href="../../../introduction/cs/methods#properties">Property</a> for the brain to set:</p>
<pre><code class="language-cs">    public bool IsHolding { get; set; }

    protected override void OnEnable()
    {
        base.OnEnable();
        IsHolding = true;
    }

    private void OnDisable()
    {
        IsHolding = false;
    }
</code></pre>
<p>Then we can use that property and the animation time to determine if we still want to apply the extra <code>_HoldForce</code>:</p>
<pre><code class="language-cs">    protected override void FixedUpdate()
    {
        base.FixedUpdate();

        if (IsHolding &amp;&amp; <a href="/animancer/api/Animancer/AnimancerState/840B3EB1">AnimancerState.Time</a> &lt;= _HoldDuration)
            Creature.Rigidbody.velocity += new Vector2(0, _HoldForce * Time.deltaTime);
    }
}
</code></pre>
<p>Note that where the base <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/JumpState">JumpState</a></code> applied its force all at once in <code>OnEnable</code>, here we want to apply the force constantly over time so we multiply it by <code>Time.deltaTime</code>.</p>
<p>The <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/LocalPlayerBrain">LocalPlayerBrain</a></code> already has a <code>CreatureState _Attack</code> field, but since we want to access that <code>IsHolding</code> property we will give it an <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/AdvancedJumpState">AdvancedJumpState</a> _Jump</code> field:</p>
<pre><code class="language-cs">// In LocalPlayerBrain:

[SerializeField] private <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/AdvancedJumpState">AdvancedJumpState</a> _Jump;

private void Update()
{
    ...

    if (Input.GetButtonDown("Jump"))// Space by default.
        Creature.StateMachine.TrySetState(_Jump);

    if (Input.GetButtonUp("Jump"))
        _Jump.IsHolding = false;

    ...
}
</code></pre>
<p>The <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/AdvancedJumpState">AdvancedJumpState</a></code> could also support other mechanics which are not used by most creatures. For example, it could allow wall jumping by overriding <code>CanEnterState</code> to check if the character is currently in the air next to a wall.</p>
<h1 id="life">Life</h1>
<p>This example does not actually have any hazards that can harm the player, but it includes a simple <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/Health">Health</a></code> script for the sake of implementing <a href="#death">Death</a>:</p>
<p>We use a <a href="../../../introduction/cs/variables#serialized-fields">Serialized Field</a> to allow the maximum health to be configured in the Inspector:</p>
<pre><code class="language-cs">public sealed class <a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/Health">Health</a> : MonoBehaviour
{
    [SerializeField]
    private int _MaxHealth;
    public int MaxHealth =&gt; _MaxHealth;
</code></pre>
<p>This script does not need to specifically know what will happen when the health value is changed. Something probably happens when it reaches 0 and the player might want to display their health somwhere, but other objects might not need to do anything in response to most health changes. So instead of hard coding a response into this script, we can give it a <a href="../../../introduction/cs/methods#delegates">Delegate</a> which other scripts can assign the appropriate callback method to:</p>
<pre><code class="language-cs">    public event Action OnHealthChanged;
</code></pre>
<p><code>DieState</code> uses that event below.</p>
<p>We need to store the current health in a field, but we do not want other scripts to modify it directly so we make it <a href="../../../introduction/cs/organisation#access-modifiers"><code>private</code></a> and use a <a href="../../../introduction/cs/organisation#access-modifiers"><code>public</code></a> <a href="../../../introduction/cs/methods#properties">Property</a> to access it:</p>
<pre><code class="language-cs">    private int _CurrentHealth;
    public int CurrentHealth
    {
        get =&gt; _CurrentHealth;
        set
        {
</code></pre>
<p>When something sets the <code>CurrentHealth</code>, we want to make sure the value is not negative or higher than the maximum value:</p>
<pre><code class="language-cs">            _CurrentHealth = Mathf.Clamp(value, 0, _MaxHealth);
</code></pre>
<p>Then we invoke the <code>OnHealthChanged</code> <a href="../../../introduction/cs/methods#delegates">Delegate</a> if we have one. But just in case we have not been given one by another script we will destroy the object this script is attached to when the health reaches 0.</p>
<pre><code class="language-cs">            if (OnHealthChanged != null)
                OnHealthChanged();
            else if (_CurrentHealth == 0)
                Destroy(gameObject);
        }
    }
</code></pre>
<p>And finally we need to actually initialise the current health on startup:</p>
<pre><code class="language-cs">    private void Awake()
    {
        CurrentHealth = _MaxHealth;
    }
}
</code></pre>
<h1 id="death">Death</h1>
<p>With the <code><a href="/animancer/api/Animancer.Examples.StateMachines.Platformer/Health">Health</a></code> script in place, we can implement our <code>DieState</code> which will not be activated by the brain like most other states but will instead register its own callback to the <code>OnHealthChanged</code> event to have the creature set it as the active state at 0 health:</p>
<pre><code class="language-cs">public sealed class DieState : CreatureState
{
    [SerializeField] private AnimationClip _Animation;

    private void Awake()
    {
        Creature.Health.OnHealthChanged += () =&gt;
        {
            if (Creature.Health.CurrentHealth &lt;= 0)
            {
                Creature.StateMachine.ForceSetState(this);
            }
        };
    }
</code></pre>
<p>When the creature actually enters this state, we play its animation:</p>
<pre><code class="language-cs">    private void OnEnable()
    {
        Creature.Animancer.Play(_Animation);
    }
</code></pre>
<p>We also want to prevent the brain or anything else from performing actions now that the creature is dead:</p>
<pre><code class="language-cs">    public override bool CanExitState =&gt; false;
}
</code></pre>
<p>This is demonstrated by a <a href="../../basics/scene-setup#buttons">UI Button</a> in the scene which sets the <code>CurrentHealth</code> value to 0.</p>
<h2 id="revival">Revival</h2>
<p>In order to allow you to continue playing around with this example scene without needing to exit Play Mode after clicking the "Die" button, we also have the ability to revive the character by playing the same animation in reverse.</p>
<p>So if the <code>CurrentHealth</code> is changed to 0, we enter the <code>DieState</code> as above and make sure the animation is playing forwards:</p>
<pre><code class="language-cs">Creature.Health.OnHealthChanged += () =&gt;
{
    if (Creature.Health.CurrentHealth &lt;= 0)
    {
        Creature.StateMachine.ForceSetState(this);
        var state = Creature.Animancer.States[_Animation];
        state.Speed = 1;
    }
</code></pre>
<p>Otherwise if the <code>CurrentHealth</code> is not 0 but this script is enabled (because the creature was previously dead) we want to reverse the animation and return to the <code>IdleState</code> when it ends:</p>
<pre><code class="language-cs">    else if (enabled)
    {
        var state = Creature.Animancer.States[_Animation];
        state.Speed = -1;
        if (state.NormalizedTime &gt; 1)
            state.NormalizedTime = 1;
        state.Events.OnEnd = Creature.ForceEnterIdleState;
    }
};
</code></pre>
<p>Since we are using <code>ForceEnterIdleState</code>, it will ignore the fact that <code>CanExitState</code> returns false.</p>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                <strong><div style="text-align:left; display:flex">

<div>
<p>Documentation</p>
<p><a href="/animancer/docs/examples">Examples</a></p>
<p><a href="/animancer/docs/manual">User Manual</a></p>
<p><a href="/animancer/docs/changes">Change Log</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Download</p>
<p><a href="https://kybernetik.itch.io/animancer-pro">Itch.io (Recommended)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-pro-116514?aid=1100l8ah5">Asset Store (Animancer Pro)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-lite-116516?aid=1100l8ah5">Asset Store (Animancer Lite)</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Contact</p>
<p><a href="https://github.com/KybernetikGames/animancer/issues">Github Issues</a></p>
<p><a href="/animancer/forum">Unity Forum</a></p>
<p><a href="mailto:animancer@kybernetik.com.au?subject=Animancer">Email</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Other Assets</p>
<p><a href="/inspector-gadgets">Inspector Gadgets</a></p>
<p><a href="/weaver">Weaver</a></p>
<p><a href="/ultevents">UltEvents</a></p>
</div>

</div></strong>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>