<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <title>Animancer - 07 Layers</title>
        <link href="/animancer/assets/css/highlight.css" rel="stylesheet">
        <link href="/animancer/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/animancer/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/animancer/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/animancer/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/animancer/assets/css/override.css" rel="stylesheet">
        <script src="/animancer/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/animancer/assets/js/bootstrap.min.js"></script>        
        <script src="/animancer/assets/js/app.min.js"></script>         
        <script src="/animancer/assets/js/highlight.pack.js"></script>   
        <script src="/animancer/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/animancer/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/animancer/assets/js/mermaid.min.js"></script>
        <script src="/animancer/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/animancer/assets/js/html5shiv.min.js"></script>
        <script src="/animancer/assets/js/respond.min.js"></script>
        <![endif]-->  

        
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/animancer/" class="logo">
                            <span>Animancer</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li><a href="/animancer/docs/introduction/features"><img src="/animancer/images/features.png" height="20px" width="20px" style="left:-7px"> Features</a></li>
        <li><a href="/animancer/docs/download"><img src="/animancer/images/download.png" height="20px" width="20px" style="left:-7px"> Download</a></li>
        <li class="active"><a href="/animancer/docs"><img src="/animancer/images/docs.png" height="20px" width="7.5px" style="left:-5px"> Documentation</a></li>
        <li><a href="/animancer/docs/help"><img src="/animancer/images/help.png" height="20px" width="10.625px" style="left:-4px"> Help</a></li>
        <li><a href="/animancer/api/Animancer/AnimancerComponent"><img src="/animancer/images/api.png" height="20px" width="18.125px" style="left:-3px"> API v6.1</a></li>
        <li><a href="/kailas-dierk/unity-assets"><img src="/animancer/images/kybernetik.png" height="20px" width="20px" style="left:-2px"> Other Assets</a></li>

<li style="width:100%">
<form class="search-form" name="search" action="/animancer/search">
<span><input class="search-input" id="search" name="q" type="text" placeholder="Search..."></span>
<div class="search-button"><button type="submit"><i class="fa fa-search"></i></button></div>
</form>
</li> 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#constants">Constants</a></p>
<p><a href="#basic-implementation">Basic Implementation</a></p>
<p><a href="#playing-with-layers">Playing With Layers</a></p>
<p><a href="#avatar-mask">Avatar Mask</a></p>
<p><a href="#layer-changing">Layer Changing</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li><a href="/animancer/docs/download">Download</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction">Introduction</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/features">Features</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer">Mecanim vs. Animancer</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/why">Why Replace Mecanim?</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/simplicity">Simplicity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/transparency">Transparency</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/adaptability">Adaptability</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/clarity">Clarity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/safety">Safety</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/reliability">Reliability</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison">Comparison</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/playing">Playing</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/waiting">Waiting</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/speed-and-time">Speed and Time</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/weapon-animations">Weapon Animations</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/conversion">Conversion</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/performance">Performance</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/glossary">Glossary</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/cs">C# in Unity</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/cs/overview">Scripting Overview</a></li>
                <li><a href="/animancer/docs/introduction/cs/organisation">Organisation</a></li>
                <li><a href="/animancer/docs/introduction/cs/variables">Variables</a></li>
                <li><a href="/animancer/docs/introduction/cs/methods">Methods</a></li>
                <li><a href="/animancer/docs/introduction/cs/inheritance">Inheritance</a></li>
                <li><a href="/animancer/docs/introduction/cs/vectors">Vectors</a></li>
                <li><a href="/animancer/docs/introduction/cs/other">Other Topics</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/examples">Examples</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/examples/basics">01 Basics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/basics/scene-setup">Basic Scene Setup</a></li>
                <li><a href="/animancer/docs/examples/basics/quick-play">01 Quick Play</a></li>
                <li><a href="/animancer/docs/examples/basics/playing-and-fading">02 Playing and Fading</a></li>
                <li><a href="/animancer/docs/examples/basics/sequence-coroutine">03 Sequence Coroutine</a></li>
                <li><a href="/animancer/docs/examples/basics/named-animations">04 Named Animations</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/fine-control">02 Fine Control</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/fine-control/spider-bot">01 Spider Bot</a></li>
                <li><a href="/animancer/docs/examples/fine-control/doors">02 Doors</a></li>
                <li><a href="/animancer/docs/examples/fine-control/solo-animation">03 Solo Animation</a></li>
                <li><a href="/animancer/docs/examples/fine-control/update-rate">04 Update Rate</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/locomotion">03 Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/locomotion/walk-and-run">01 Walk and Run</a></li>
                <li><a href="/animancer/docs/examples/locomotion/root-motion">02 Root Motion</a></li>
                <li><a href="/animancer/docs/examples/locomotion/linear-blending">03 Linear Blending</a></li>
                <li><a href="/animancer/docs/examples/locomotion/directional-blending">04 Directional Blending</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/directional-sprites">04 Directional Sprites</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/directional-sprites/basic-movement">01 Basic Movement</a></li>
                <li><a href="/animancer/docs/examples/directional-sprites/character-controller">02 Character Controller</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/events">05 Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/events/footsteps">01 Footstep Events</a></li>
                <li><a href="/animancer/docs/examples/events/golf">02 Golf Events</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/fsm">06 State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/examples/fsm/game-manager">01 Game Manager</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/fsm/game-manager/enum">Enum</a></li>
                <li><a href="/animancer/docs/examples/fsm/game-manager/fsm">FSM</a></li>
                <li><a href="/animancer/docs/examples/fsm/game-manager/comparison">Comparison</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/fsm/creatures">02 Creatures</a></li>
                <li><a href="/animancer/docs/examples/fsm/interrupts">03 Interrupt Management</a></li>
                <li><a href="/animancer/docs/examples/fsm/brains">04 Brains</a></li>
                <li><a href="/animancer/docs/examples/fsm/more-brains">05 More Brains</a></li>
                <li><a href="/animancer/docs/examples/fsm/weapons">06 Weapons</a></li>
                <li><a href="/animancer/docs/examples/fsm/platformer">07 Platformer</a></li>

                    </ul>
                </li>
                <li class="selected"><a href="/animancer/docs/examples/layers">07 Layers</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/ik">08 Inverse Kinematics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/ik/puppet">01 Puppet</a></li>
                <li><a href="/animancer/docs/examples/ik/uneven-ground">02 Uneven Ground</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers">09 Animator Controllers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/basics">01 Hybrid Basics</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/mini-game">02 Hybrid Mini Game</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers/3d-game-kit">03 3D Game Kit</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/problems">Problems with the Mecanim Character</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/respawn">Respawn</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/idle">Idle</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion">Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion/movement">Movement</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/locomotion/turning">Turning</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/airborne">Airborne</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/landing">Landing</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/attack">Attack</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/flinch">Flinch</a></li>
                <li><a href="/animancer/docs/examples/animator-controllers/3d-game-kit/die">Die</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/jobs">10 Animation Jobs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/jobs/two-bone-ik">01 Two Bone IK</a></li>
                <li><a href="/animancer/docs/examples/jobs/damping">02 Damping</a></li>
                <li><a href="/animancer/docs/examples/jobs/lean">03 Lean</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/examples/integration">Integration</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/examples/integration/animation-rigging">Animation Rigging</a></li>
                <li><a href="/animancer/docs/examples/integration/dynamic-bone">Dynamic Bone</a></li>
                <li><a href="/animancer/docs/examples/integration/final-ik">Final IK</a></li>
                <li><a href="/animancer/docs/examples/integration/hairibar-ragdoll">Hairibar Ragdoll</a></li>
                <li><a href="/animancer/docs/examples/integration/puppet-master">Puppet Master</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/examples/no-video-tutorials">No Video Tutorials</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual">User Manual</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/manual/getting">Getting Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/getting/mixamo">Mixamo</a></li>
                <li><a href="/animancer/docs/manual/getting/importing">Importing</a></li>
                <li><a href="/animancer/docs/manual/getting/animation-window">Animation Window</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/playing">Playing Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/playing/states">States</a></li>
                <li><a href="/animancer/docs/manual/playing/inspector">Inspector</a></li>
                <li><a href="/animancer/docs/manual/playing/component-types">Component Types</a></li>
                <li><a href="/animancer/docs/manual/playing/directional-sets">Directional Animation Sets</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/transitions">Transitions</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/transitions/types">Transition Types</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending">Blending</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/blending/fading">Fading</a></li>
                <li><a href="/animancer/docs/manual/blending/layers">Layers</a></li>
                <li><a href="/animancer/docs/manual/blending/mixers">Mixers</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/events">Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/events/animation">Animation Events</a></li>
                <li><a href="/animancer/docs/manual/events/animancer">Animancer Events</a></li>
                <li><a href="/animancer/docs/manual/events/end">End Events</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/fsm">Finite State Machines</a></li>
                <li><a href="/animancer/docs/manual/animator-controllers">Animator Controllers</a></li>
                <li><a href="/animancer/docs/manual/timeline">Timeline</a></li>
                <li><a href="/animancer/docs/manual/ik">Inverse Kinematics</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/tools">Animancer Tools</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/tools/pack-textures">Pack Textures</a></li>
                <li><a href="/animancer/docs/manual/tools/modify-sprites">Modify Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/rename-sprites">Rename Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/generate-sprite-animations">Generate Sprite Animations</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-sprite-animation">Remap Sprite Animation</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-animation-bindings">Remap Animation Bindings</a></li>
                <li><a href="/animancer/docs/manual/tools/sprite-renderer-texture-swap">Sprite Renderer Texture Swap</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/bugs">Unity Bugs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/bugs/events">Animation Events</a></li>
                <li><a href="/animancer/docs/bugs/rigging-ik">Animation Rigging IK</a></li>
                <li><a href="/animancer/docs/bugs/animator-controller-speed">Animator Controller Speed</a></li>
                <li><a href="/animancer/docs/bugs/paused-skinned-mesh-update">Paused Skinned Mesh Update</a></li>
                <li><a href="/animancer/docs/bugs/serialized-array-initialization">Serialized Array Initialization</a></li>
                <li><a href="/animancer/docs/bugs/stabilize-feet">Stabilize Feet</a></li>
                <li><a href="/animancer/docs/bugs/timeline">Timeline</a></li>
                <li><a href="/animancer/docs/bugs/timing">Timing</a></li>
                <li><a href="/animancer/docs/bugs/update-modes">Update Modes</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/source">Source Code</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/source/dlls">DLLs</a></li>
                <li><a href="/animancer/docs/source/creating-custom-states">Creating Custom States</a></li>
                <li><a href="/animancer/docs/source/graph-structure">Graph Structure</a></li>
                <li><a href="/animancer/docs/source/asset-sources">Asset Sources</a></li>
                <li><a href="/animancer/docs/source/coding-standard">Coding Standard</a></li>
                <li><a href="/animancer/docs/source/default-script-template">Default Script Template</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/changes">Change Log</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v6-1">Animancer v6.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v6-0">Animancer v6.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v6-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v5-3">Animancer v5.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-2">Animancer v5.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-1">Animancer v5.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v5-0">Animancer v5.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v5-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v4-4">Animancer v4.4</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-3">Animancer v4.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-2">Animancer v4.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-1">Animancer v4.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v4-0">Animancer v4.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v4-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v3-1">Animancer v3.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v3-0">Animancer v3.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v2-0">Animancer v2.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-3">Animancer v1.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-2">Animancer v1.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-1">Animancer v1.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-0">Animancer v1.0</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/help">Help and FAQ</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/help/debugging">Debugging</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>07 Layers</h1>
		</section>
	<section class="content">
		<blockquote class="blockquote">
<p><strong>Difficulty</strong>: <a href="../../introduction/glossary#example-difficulty">Intermediate</a> - Recommended after <a href="../basics/quick-play">Quick Play</a></p>
<p><strong>Location</strong>: <em>Assets/Plugins/Animancer/Examples/07 Layers</em></p>
<p><strong>Namespace</strong>: <a href="../../../api/Animancer.Examples.Layers"><code>Animancer.Examples.Layers</code></a></p>
</blockquote>
<p>This example demonstrates how you can use <a href="../../manual/blending/layers">Layers</a> and masks to play multiple animations at the same time on different body parts. If the <em>Action</em> (a tennis swing) is performed while the character is <em>Idle</em>, it is played on the default layer so that it controls the full body. But if it is performed while the <em>Run</em> animation is playing, the <em>Action</em> is played on another layer which is masked to only affect the upper body, so the legs continue running while the upper body acts independantly without needing to actually make a <em>RunningTennisSwing</em> animation.</p>
<p><em><a href="../../manual/blending/layers">Layers</a> are a <a href="../../introduction/features"><strong>Pro-Only Feature</strong></a>. You can try them out in the Unity Editor with <a href="/animancer/lite">Animancer Lite</a>, but they are not available in runtime builds unless you purchase <a href="/animancer/pro">Animancer Pro</a>.</em></p>
<p><img src="layers.gif" class="img-responsive"></p>
<p></p><details><summary>The <code><a href="/animancer/api/Animancer.Examples.Layers/LayerExample">LayerExample</a></code> script looks like this (with the comments removed since we're about to explain how it works):</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class <a href="/animancer/api/Animancer.Examples.Layers/LayerExample">LayerExample</a> : MonoBehaviour
{
    [SerializeField] private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _BasicAnimancer;
    [SerializeField] private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _LayeredAnimancer;

    [SerializeField] private AnimationClip _Idle;
    [SerializeField] private AnimationClip _Run;
    [SerializeField] private AnimationClip _Action;

    [SerializeField] private AvatarMask _ActionMask;

    private const int BaseLayer = 0;
    private const int ActionLayer = 1;

    private const float FadeDuration = 0.25f;

    private void OnEnable()
    {
        _BasicAnimancer.Play(_Idle);
        _LayeredAnimancer.Play(_Idle);

        _LayeredAnimancer.Layers[ActionLayer].SetMask(_ActionMask);
        _LayeredAnimancer.Layers[ActionLayer].SetName("Action Layer");
    }

    private bool _IsRunning;

    public void ToggleRunning()
    {
        _IsRunning = !_IsRunning;

        var animation = _IsRunning ? _Run : _Idle;

        _BasicAnimancer.Play(animation, FadeDuration);
        _LayeredAnimancer.Play(animation, FadeDuration);
    }

    public void PerformAction()
    {
        var state = _BasicAnimancer.Play(_Action, FadeDuration);
        state.Events.OnEnd = () =&gt; _BasicAnimancer.Play(_IsRunning ? _Run : _Idle, FadeDuration);

        if (_IsRunning)
        {
            state = _LayeredAnimancer.Layers[ActionLayer].Play(_Action, FadeDuration, FadeMode.FromStart);
            state.Events.OnEnd = () =&gt; _LayeredAnimancer.Layers[ActionLayer].StartFade(0, FadeDuration);
        }
        else
        {
            state = _LayeredAnimancer.Layers[BaseLayer].Play(_Action, FadeDuration, FadeMode.FromStart);
            state.Events.OnEnd = () =&gt; _LayeredAnimancer.Play(_Idle, FadeDuration);
        }
    }
}
</code></pre>
<p></p></details><p></p>
<h1 id="constants">Constants</h1>
<p>There are several values we want to use multiple times throughout the script so we could simply repeat them every time:</p>
<pre><code class="language-cs">state = _LayeredAnimancer.Layers[1].Play(_Action, 0.25f, FadeMode.FromStart);
state.Events.OnEnd = () =&gt; _LayeredAnimancer.Layers[1].StartFade(0, 0.25f);
</code></pre>
<p>But then it is not totally clear which values are connected, which can become a problem in larger scripts. What does "<code>1</code>" mean here? What else are we using that layer for? Is every "<code>1</code>" in the script referring to that layer? If we want to change all the fade durations, do we really need to go through the entire script to change them manually? And so on.</p>
<p>Alternatively, we can use some <code>const</code> fields:</p>
<pre><code class="language-cs">private const int BaseLayer = 0;
private const int ActionLayer = 1;

private const float FadeDuration = 0.25f;

...

state = _LayeredAnimancer.Layers[ActionLayer].Play(_Action, FadeDuration, FadeMode.FromStart);
state.Events.OnEnd = () =&gt; _LayeredAnimancer.Layers[ActionLayer].StartFade(0, FadeDuration);
</code></pre>
<p>Now it is clear that we are specifically using the layer on which actions are performed and using the same fade duration for everything. And since the compiler knows that the constants can never change at runtime, it will actually compile this into the exact same thing as above so we do not lose any performance (using a non-<code>const</code> field would cost a bit of performance because it needs to look up the current value each time it is accessed).</p>
<p>Note that we are using terms like <code>_Action</code> and <code>ActionLayer</code> instead of calling them <code>_TennisSwing</code> and <code>UpperBodyLayer</code>. There is nothing in the script that is actually specific to a "tennis swing" or the "upper body", it could work just as well with any other mask or animation so we use general names just in case we ever want to reuse the script in another situation.</p>
<h1 id="basic-implementation">Basic Implementation</h1>
<p>The characters in this example can <em>Idle</em>, <em>Run</em>, and perform an <em>Action</em> (a tennis swing). Implementing this behaviour using a single-layer is done like many of the other examples:</p>
<p>Play the <em>Idle</em> on startup:</p>
<pre><code class="language-cs">private void OnEnable()
{
    _BasicAnimancer.Play(_Idle);
}
</code></pre>
<p>Make a method to switch between <em>Idle</em> and <em>Run</em>, and expose it as <code>public</code> so it can be called by a <a href="../../basics/scene-setup#buttons">UI Button</a>:</p>
<pre><code class="language-cs">private bool _IsRunning;

public void ToggleRunning()
{
    // Swap between true and false.
    _IsRunning = !_IsRunning;

    // Determine which animation to play.
    var animation = _IsRunning ? _Run : _Idle;

    // Play it.
    _BasicAnimancer.Play(animation, FadeDuration);
}
</code></pre>
<p>And another <code>public</code> method to play the <em>Action</em> then return to whichever animation it was playing before:</p>
<pre><code class="language-cs">public void PerformAction()
{
    var state = _BasicAnimancer.Play(_Action, FadeDuration);
    state.Events.OnEnd = () =&gt; _BasicAnimancer.Play(_IsRunning ? _Run : _Idle, FadeDuration);
}
</code></pre>
<h1 id="playing-with-layers">Playing With Layers</h1>
<p>For the layered character, we do the exact same things in <code>OnEnable</code> and <code>ToggleRunning</code> to control the movement on the base layer:</p>
<pre><code class="language-cs">private void OnEnable()
{
    _BasicAnimancer.Play(_Idle);
    _LayeredAnimancer.Play(_Idle);
}

public void ToggleRunning()
{
    ...

    _BasicAnimancer.Play(animation, FadeDuration);
    _LayeredAnimancer.Play(animation, FadeDuration);
}
</code></pre>
<p>But <code>PerformAction</code> is different. We want to play the <code>_Action</code> animation on the <code>ActionLayer</code> so that the <code>_Idle</code> or <code>_Run</code> can keep playing on the <code>BaseLayer</code> at the same time:</p>
<pre><code class="language-cs">public void PerformAction()
{
    ...

    state = _LayeredAnimancer.Layers[ActionLayer].Play(_Action, FadeDuration);
</code></pre>
<p>Then when it ends we fade that layer out because we do not have anything else for it to do at the moment and do not want the character to continue showing the end of the action:</p>
<pre><code class="language-cs">    state.Events.OnEnd = () =&gt; _LayeredAnimancer.Layers[ActionLayer].StartFade(0, FadeDuration);
}
</code></pre>
<p>This achieves an almost identical result for both characters. The only difference is that the layered character's <em>Idle</em> or <em>Run</em> animation continues playing in the background during the <em>Action</em> so that when it ends we can just fade the layer out instead of needing to figure out which one to go back to.</p>
<p><img src="unmasked.gif" class="img-responsive"></p>
<h1 id="avatar-mask">Avatar Mask</h1>
<p>Layers that simply override each other can be useful, but one of their most powerful features is the ability to use <code>AvatarMask</code>s to determine which body parts each layer affects.</p>
<p><img src="upper-body-mask.png" class="img-responsive img-right"> You can create a mask via the <em>Assets/Create/Avatar Mask</em> menu function. The mask we are using in this example has its <code>Humanoid</code> values set to only include the upper body.</p>
<p>Once we have a mask, we can add a <a href="../../../introduction/cs/variables#serialized-fields">Serialized Field</a> (to assign it in the Inspector) and set the <code>ActionLayer</code> to use it on startup:</p>
<pre><code class="language-cs">[SerializeField] private AvatarMask _ActionMask;

private void OnEnable()
{
    _BasicAnimancer.Play(_Idle);
    _LayeredAnimancer.Play(_Idle);

    _LayeredAnimancer.Layers[ActionLayer].SetMask(_ActionMask);
</code></pre>
<p>Since we set a mask it will use the name of the mask in the Inspector by default. But we can also replace it with a custom name. Either way, layer names are only used in the Inspector and any calls to <code>SetName</code> will be compiled out of runtime builds so they have no effect on performance (because that method has a [<a href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.conditionalattribute"><code>Conditional</code>]</a> attribute applied to it):</p>
<pre><code class="language-cs">    _LayeredAnimancer.Layers[ActionLayer].SetName("Action Layer");
}
</code></pre>
<p>Now we have a character that can perform an action with their upper body while their lower body continues doing whatever it was previously doing:</p>
<p><img src="masked.gif" class="img-responsive"></p>
<p>The official <a href="https://learn.unity.com/tutorial/character-animation#5c7f8528edbc2a002053b4fc">Character Animation</a> tutorial has a section which explains how to create <code>AvatarMask</code>s in more detail.</p>
<h1 id="layer-changing">Layer Changing</h1>
<p>The <em>Action</em> animation already has the character effectively standing still but has appropriate foot movements for the swing which the <em>Idle</em> animation does not, so when the character is <em>Idle</em> we might want to allow it to affect the whole body instead of only ever the upper body. To do this, we can simply change the layer we want to play it on depending on the current state:</p>
<pre><code class="language-cs">// In PerformAction:
if (_IsRunning)
{
    state = _LayeredAnimancer.Layers[ActionLayer].Play(_Action, FadeDuration);
    state.Events.OnEnd = () =&gt; _LayeredAnimancer.Layers[ActionLayer].StartFade(0, FadeDuration);
}
else
{
    state = _LayeredAnimancer.Layers[BaseLayer].Play(_Action, FadeDuration);

    // Return to Idle instead of fading the BaseLayer out.
    state.Events.OnEnd = () =&gt; _LayeredAnimancer.Play(_Idle, FadeDuration);
}
</code></pre>
<p>Doing that has one notable problem though: if it changes the layer while the animation is already playing (specifically, when its <code><a href="/animancer/api/Animancer/AnimancerNode/94B3FD61">AnimancerNode.Weight</a></code> is not 0 so it is actually affecting the model) then it will not be able to blend smoothly from the previous pose. We can fix this by setting the optional <code><a href="/animancer/api/Animancer/FadeMode">FadeMode</a></code> parameter of the <a href="../../../manual/playing#play-methods">Play Method</a> to <code>FadeMode.FromStart</code>:</p>
<pre><code class="language-cs">// In PerformAction:
if (_IsRunning)
{
    state = _LayeredAnimancer.Layers[ActionLayer].Play(_Action, FadeDuration, FadeMode.FromStart);
    state.Events.OnEnd = () =&gt; _LayeredAnimancer.Layers[ActionLayer].StartFade(0, FadeDuration);
}
else
{
    state = _LayeredAnimancer.Layers[BaseLayer].Play(_Action, FadeDuration, FadeMode.FromStart);
    state.Events.OnEnd = () =&gt; _LayeredAnimancer.Play(_Idle, FadeDuration);
}
</code></pre>
<p></p><details><summary>The full <code><a href="/animancer/api/Animancer.Examples.Layers/LayerExample">LayerExample</a></code> script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class <a href="/animancer/api/Animancer.Examples.Layers/LayerExample">LayerExample</a> : MonoBehaviour
{
    [SerializeField] private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _BasicAnimancer;
    [SerializeField] private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _LayeredAnimancer;

    [SerializeField] private AnimationClip _Idle;
    [SerializeField] private AnimationClip _Run;
    [SerializeField] private AnimationClip _Action;

    [SerializeField] private AvatarMask _ActionMask;

    private const int BaseLayer = 0;
    private const int ActionLayer = 1;

    private const float FadeDuration = 0.25f;

    private void OnEnable()
    {
        _BasicAnimancer.Play(_Idle);
        _LayeredAnimancer.Play(_Idle);

        _LayeredAnimancer.Layers[ActionLayer].SetMask(_ActionMask);
        _LayeredAnimancer.Layers[ActionLayer].SetName("Action Layer");
    }

    private bool _IsRunning;

    public void ToggleRunning()
    {
        _IsRunning = !_IsRunning;

        var animation = _IsRunning ? _Run : _Idle;

        _BasicAnimancer.Play(animation, FadeDuration);
        _LayeredAnimancer.Play(animation, FadeDuration);
    }

    public void PerformAction()
    {
        var state = _BasicAnimancer.Play(_Action, FadeDuration);
        state.Events.OnEnd = () =&gt; _BasicAnimancer.Play(_IsRunning ? _Run : _Idle, FadeDuration);

        if (_IsRunning)
        {
            state = _LayeredAnimancer.Layers[ActionLayer].Play(_Action, FadeDuration, FadeMode.FromStart);
            state.Events.OnEnd = () =&gt; _LayeredAnimancer.Layers[ActionLayer].StartFade(0, FadeDuration);
        }
        else
        {
            state = _LayeredAnimancer.Layers[BaseLayer].Play(_Action, FadeDuration, FadeMode.FromStart);
            state.Events.OnEnd = () =&gt; _LayeredAnimancer.Play(_Idle, FadeDuration);
        }
    }
}
</code></pre>
<p></p></details><p></p>
<p>So now the character plays the <em>Action</em> animation normally if they were <em>Idle</em> or plays it on the upper body only if they were <em>Running</em>:</p>
<p><img src="layers.gif" class="img-responsive"></p>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                <strong><div style="text-align:left; display:flex">

<div>
<p>Documentation</p>
<p><a href="/animancer/docs/examples">Examples</a></p>
<p><a href="/animancer/docs/manual">User Manual</a></p>
<p><a href="/animancer/docs/changes">Change Log</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Download</p>
<p><a href="https://kybernetik.itch.io/animancer-pro">Itch.io (Recommended)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-pro-116514?aid=1100l8ah5">Asset Store (Animancer Pro)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-lite-116516?aid=1100l8ah5">Asset Store (Animancer Lite)</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Contact</p>
<p><a href="https://github.com/KybernetikGames/animancer/issues">Github Issues</a></p>
<p><a href="/animancer/forum">Unity Forum</a></p>
<p><a href="mailto:animancer@kybernetik.com.au?subject=Animancer">Email</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Other Assets</p>
<p><a href="/inspector-gadgets">Inspector Gadgets</a></p>
<p><a href="/weaver">Weaver</a></p>
<p><a href="/ultevents">UltEvents</a></p>
</div>

</div></strong>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>