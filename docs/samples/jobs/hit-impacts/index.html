<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/animancer/assets/img/favicon.ico" type="image/x-icon">
        <title>Animancer - 10-03 Hit Impacts</title>
        <link href="/animancer/assets/css/highlight.css" rel="stylesheet">
        <link href="/animancer/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/animancer/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/animancer/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/animancer/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/animancer/assets/css/override.css" rel="stylesheet">
        <script src="/animancer/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/animancer/assets/js/bootstrap.min.js"></script>        
        <script src="/animancer/assets/js/app.min.js"></script>         
        <script src="/animancer/assets/js/highlight.pack.js"></script>   
        <script src="/animancer/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/animancer/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/animancer/assets/js/mermaid.min.js"></script>
        <script src="/animancer/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/animancer/assets/js/html5shiv.min.js"></script>
        <script src="/animancer/assets/js/respond.min.js"></script>
        <![endif]-->  

        
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/animancer/" class="logo">
                            <span>Animancer</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li><a href="/animancer/docs/introduction/features"><img src="/animancer/images/icons/features.png" height="20px" width="20px" style="left:-7px"> Features</a></li>
        <li><a href="/animancer/docs/download"><img src="/animancer/images/icons/download.png" height="20px" width="20px" style="left:-7px"> Download</a></li>
        <li class="active"><a href="/animancer/docs"><img src="/animancer/images/icons/docs.png" height="20px" width="7.5px" style="left:-5px"> Documentation</a></li>
        <li><a href="/animancer/docs/help"><img src="/animancer/images/icons/help.png" height="20px" width="10.625px" style="left:-4px"> Help</a></li>
        <li><a href="/animancer/api/Animancer/AnimancerComponent"><img src="/animancer/images/icons/api.png" height="20px" width="18.125px" style="left:-3px"> API v8.0</a></li>
        <li><a href="https://kybernetik.com.au"><img src="/animancer/images/icons/kybernetik.png" height="20px" width="20px" style="left:-2px"> Other Assets</a></li>

<li style="width:100%">
<form class="search-form" name="search" action="/animancer/search">
<span><input class="search-input" id="search" name="q" type="text" placeholder="Search..."></span>
<div class="search-button"><button type="submit"><i class="fa fa-search"></i></button></div>
</form>
</li> 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#summary">Summary</a></p>
<p><a href="#overview">Overview</a></p>
<p><a href="#initialization">Initialization</a></p>
<p><a href="#axis">Axis</a></p>
<p><a href="#angle">Angle</a></p>
<p><a href="#cleanup">Cleanup</a></p>
<p><a href="#job">Job</a></p>
<p><a href="#hit-receiver">Hit Receiver</a></p>
<p><a href="#click-to-hit">Click To Hit</a></p>
<p><a href="#conclusion">Conclusion</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li><a href="/animancer/docs/download">Download</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction">Introduction</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/features">Features</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer">Mecanim vs. Animancer</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/why">Why Replace Mecanim?</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/simplicity">Simplicity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/transparency">Transparency</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/adaptability">Adaptability</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/clarity">Clarity</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/safety">Safety</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/why/reliability">Reliability</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison">Comparison</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/playing">Playing</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/waiting">Waiting</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/speed-and-time">Speed and Time</a></li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/comparison/weapon-animations">Weapon Animations</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/mecanim-vs-animancer/performance">Performance</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/introduction/glossary">Glossary</a></li>
                <li><a href="/animancer/docs/introduction/cs">C# in Unity</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/samples">Samples</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/samples/basics">01 Basics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/basics/quick-play">01-01 Quick Play</a></li>
                <li><a href="/animancer/docs/samples/basics/movement">01-02 Basic Movement</a></li>
                <li><a href="/animancer/docs/samples/basics/action">01-03 Basic Action</a></li>
                <li><a href="/animancer/docs/samples/basics/transitions">01-04 Transitions</a></li>
                <li><a href="/animancer/docs/samples/basics/character">01-05 Basic Character</a></li>
                <li><a href="/animancer/docs/samples/basics/library">01-06 Library Character</a></li>
                <li><a href="/animancer/docs/samples/basics/scene-setup">Basic Scene Setup</a></li>
                <li><a href="/animancer/docs/samples/basics/input">Input</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/fine-control">02 Fine Control</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/fine-control/named">02-01 Named Character</a></li>
                <li><a href="/animancer/docs/samples/fine-control/live-inspector">02-02 Live Inspector</a></li>
                <li><a href="/animancer/docs/samples/fine-control/doors">02-03 Doors</a></li>
                <li><a href="/animancer/docs/samples/fine-control/update-rate">02-04 Update Rate</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/mixers">03 Mixers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/mixers/linear">03-01 Linear Mixers</a></li>
                <li><a href="/animancer/docs/samples/mixers/directional">03-02 Directional Mixers</a></li>
                <li><a href="/animancer/docs/samples/mixers/serialization">03-03 Animation Serialization</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/layers">04 Layers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/layers/basic">04-01 Basic Layers</a></li>
                <li><a href="/animancer/docs/samples/layers/dynamic">04-02 Dynamic Layers</a></li>
                <li><a href="/animancer/docs/samples/layers/face">04-03 Facial Expressions</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/events">05 Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/events/golf">05-01 Golf Events</a></li>
                <li><a href="/animancer/docs/samples/events/footsteps">05-02 Footstep Events</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/fsm">06 State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/fsm/characters">06-01 Characters</a></li>
                <li><a href="/animancer/docs/samples/fsm/interruptions">06-02 Interruptions</a></li>
                <li><a href="/animancer/docs/samples/fsm/brains">06-03 Brains</a></li>
                <li><a href="/animancer/docs/samples/fsm/weapons">06-04 Weapons</a></li>
                <li><a href="/animancer/docs/samples/fsm/platformer">Platformer Game Kit</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/sprites">07 Sprites</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/sprites/basics">07-01 Directional Basics</a></li>
                <li><a href="/animancer/docs/samples/sprites/character">07-02 Directional Character</a></li>
                <li><a href="/animancer/docs/samples/sprites/character-3d">07-03 Directional Character 3D</a></li>
                <li><a href="/animancer/docs/samples/sprites/platformer">Platformer Game Kit</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/animator-controllers">08 Animator Controllers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/animator-controllers/character">08-01 Hybrid Character</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/animator-controllers/3d-game-kit">08-02 3D Game Kit</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/problems">Problems with the Mecanim Character</a></li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/respawn">Respawn</a></li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/idle">Idle</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/animator-controllers/3d-game-kit/locomotion">Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/locomotion/movement">Movement</a></li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/locomotion/turning">Turning</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/airborne">Airborne</a></li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/landing">Landing</a></li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/attack">Attack</a></li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/flinch">Flinch</a></li>
                <li><a href="/animancer/docs/samples/animator-controllers/3d-game-kit/die">Die</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/ik">09 Inverse Kinematics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/ik/puppet">09-01 Puppet</a></li>
                <li><a href="/animancer/docs/samples/ik/uneven-ground">09-02 Uneven Ground</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/docs/samples/jobs">10 Animation Jobs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/jobs/two-bone-ik">10-01 Two Bone IK</a></li>
                <li><a href="/animancer/docs/samples/jobs/damping">10-02 Damping</a></li>
                <li class="selected"><a href="/animancer/docs/samples/jobs/hit-impacts">10-03 Hit Impacts</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/samples/integration">Integration</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/samples/integration/animation-rigging">Animation Rigging</a></li>
                <li><a href="/animancer/docs/samples/integration/dynamic-bone">Dynamic Bone</a></li>
                <li><a href="/animancer/docs/samples/integration/final-ik">Final IK</a></li>
                <li><a href="/animancer/docs/samples/integration/hairibar-ragdoll">Hairibar Ragdoll</a></li>
                <li><a href="/animancer/docs/samples/integration/lod">Level of Detail (LOD)</a></li>
                <li><a href="/animancer/docs/samples/integration/odin-inspector">Odin Inspector</a></li>
                <li><a href="/animancer/docs/samples/integration/puppet-master">Puppet Master</a></li>
                <li><a href="/animancer/docs/samples/integration/spine">Spine</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/samples/no-video-tutorials">No Video Tutorials</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual">User Manual</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/manual/getting">Getting Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/getting/mixamo">Mixamo</a></li>
                <li><a href="/animancer/docs/manual/getting/importing">Importing</a></li>
                <li><a href="/animancer/docs/manual/getting/animation-window">Animation Window</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/playing">Playing Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/playing/states">States</a></li>
                <li><a href="/animancer/docs/manual/playing/keys">Keys</a></li>
                <li><a href="/animancer/docs/manual/playing/inspector">Inspector</a></li>
                <li><a href="/animancer/docs/manual/playing/component-types">Component Types</a></li>
                <li><a href="/animancer/docs/manual/playing/edit-mode">Playing in Edit Mode</a></li>
                <li><a href="/animancer/docs/manual/playing/directional-sets">Directional Animation Sets</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/transitions">Transitions</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/transitions/types">Transition Types</a></li>
                <li><a href="/animancer/docs/manual/transitions/assets">Transition Assets</a></li>
                <li><a href="/animancer/docs/manual/transitions/previews">Transition Previews</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending">Blending</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending/fading">Fading</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/blending/fading/modes">Fade Modes</a></li>
                <li><a href="/animancer/docs/manual/blending/fading/custom">Custom Fading</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/blending/layers">Layers</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/blending/mixers">Mixers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/blending/mixers/creation">Mixer Creation</a></li>
                <li><a href="/animancer/docs/manual/blending/mixers/smoothing">Mixer Smoothing</a></li>
                <li><a href="/animancer/docs/manual/blending/mixers/synchronization">Mixer Synchronization</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/events">Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/events/animation">Animation Events</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/events/animancer">Animancer Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/events/animancer/usage">Usage</a></li>
                <li><a href="/animancer/docs/manual/events/animancer/behaviour">Behaviour</a></li>
                <li><a href="/animancer/docs/manual/events/animancer/garbage">Garbage Collection</a></li>
                <li><a href="/animancer/docs/manual/events/animancer/utilities">Event Utilities</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/events/end">End Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/events/end/alternatives">End Event Alternatives</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/fsm">Finite State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/fsm/overview">Overview</a></li>
                <li><a href="/animancer/docs/manual/fsm/state-types">1. State Types</a></li>
                <li><a href="/animancer/docs/manual/fsm/initialization">2. Initialization</a></li>
                <li><a href="/animancer/docs/manual/fsm/changing-states">3. Changing States</a></li>
                <li><a href="/animancer/docs/manual/fsm/keys">Keys</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/fsm/utilities">Utilities</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/fsm/utilities/input-buffer">Input Buffers</a></li>
                <li><a href="/animancer/docs/manual/fsm/utilities/state-selector">State Selectors</a></li>
                <li><a href="/animancer/docs/manual/fsm/utilities/owned-states">Owned States</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/animator-controllers">Animator Controllers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/animator-controllers/conversion">Conversion</a></li>
                <li><a href="/animancer/docs/manual/animator-controllers/controller-states">Controller States</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/manual/timeline">Timeline</a></li>
                <li><a href="/animancer/docs/manual/ik">Inverse Kinematics</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/tools">Animancer Tools</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/tools/pack-textures">Pack Textures</a></li>
                <li><a href="/animancer/docs/manual/tools/modify-sprites">Modify Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/rename-sprites">Rename Sprites</a></li>
                <li><a href="/animancer/docs/manual/tools/generate-sprite-animations">Generate Sprite Animations</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-sprite-animation">Remap Sprite Animation</a></li>
                <li><a href="/animancer/docs/manual/tools/remap-animation-bindings">Remap Animation Bindings</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/manual/other">Other Features</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/manual/other/animation-clip-inspector">Animation Clip Inspector</a></li>
                <li><a href="/animancer/docs/manual/other/polymorphic">Polymorphic Drawer</a></li>
                <li><a href="/animancer/docs/manual/other/root-motion">Root Motion</a></li>
                <li><a href="/animancer/docs/manual/other/sprite-renderer-texture-swap">Sprite Renderer Texture Swap</a></li>
                <li><a href="/animancer/docs/manual/other/units">Units Attributes</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/bugs">Unity Bugs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/bugs/paused-skinned-mesh-update">Paused Skinned Mesh Update</a></li>
                <li><a href="/animancer/docs/bugs/reorderable-array-height">Reorderable Array Height</a></li>
                <li><a href="/animancer/docs/bugs/serialized-array-initialization">Serialized Array Initialization</a></li>
                <li><a href="/animancer/docs/bugs/timing">Timing</a></li>
                <li><a href="/animancer/docs/bugs/update-modes">Update Modes</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/source">Source Code</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/source/dlls">DLLs</a></li>
                <li><a href="/animancer/docs/source/creating-custom-states">Creating Custom States</a></li>
                <li><a href="/animancer/docs/source/graph-structure">Graph Structure</a></li>
                <li><a href="/animancer/docs/source/asset-sources">Asset Sources</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/changes">Change Log</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v8-0">Animancer v8.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v8-0/upgrade-guide">Animancer v8.0 Upgrade Guide</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v7-4">Animancer v7.4</a></li>
                <li><a href="/animancer/docs/changes/animancer-v7-3">Animancer v7.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v7-2">Animancer v7.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v7-1">Animancer v7.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v7-0">Animancer v7.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v6-1">Animancer v6.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v6-0">Animancer v6.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v6-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v5-3">Animancer v5.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-2">Animancer v5.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v5-1">Animancer v5.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v5-0">Animancer v5.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v5-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v4-4">Animancer v4.4</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-3">Animancer v4.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-2">Animancer v4.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v4-1">Animancer v4.1</a></li>
                <li class="treeview">
                    <a href="/animancer/docs/changes/animancer-v4-0">Animancer v4.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/changes/animancer-v4-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/docs/changes/animancer-v3-1">Animancer v3.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v3-0">Animancer v3.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v2-0">Animancer v2.0</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-3">Animancer v1.3</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-2">Animancer v1.2</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-1">Animancer v1.1</a></li>
                <li><a href="/animancer/docs/changes/animancer-v1-0">Animancer v1.0</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/docs/help">Help and FAQ</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/docs/help/debugging">Debugging</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>10-03 Hit Impacts</h1>
		</section>
	<section class="content">
		<div class="pro-only-sample"><a href="/animancer/docs/introduction/features"><div></div><ul>
<li>Animation Jobs</li>
</ul></a></div>
<blockquote class="blockquote">
<p><i class="emw fa fa-folder"></i> <a href="../../"><strong>Location</strong>: Samples/10 Animation Jobs/03 Lean</a></p>
<p><i class="emw fa fa-code-fork"></i> <strong>Recommended After</strong>: <a href="../two-bone-ik">Two Bone IK</a> and <a href="../damping">Damping</a></p>
<p><i class="emw fa fa-puzzle-piece"></i> <strong>Learning Outcomes</strong>: <span class="mini">in this sample you will learn:</span></p>
<p><i class="emw fa fa-lightbulb-o"></i> How to dynamically lean a character by rotating their spine.</p>
<p><i class="emw fa fa-lightbulb-o"></i> How to write a custom Animation Job.</p>
</blockquote>
<img src="hit-impacts.png" class="pngif img-responsive img-right">
<h1 id="summary">Summary</h1>
<p>This sample demonstrates how you can use an Animation Job to dynamically rotate a character's spine to the side as if they're being hit by an attack.</p>
<ul>
<li>Click on the ground to hit the character from that direction:
<ul>
<li>Left Click for a strong hit.</li>
<li>Right Click for a weak hit.</li>
</ul>
</li>
<li><a href="https://github.com/KybernetikGames/animancer/issues/48#issuecomment-632336377">This sample is based on a dynamic lean script by ted-hou on GitHub.</a></li>
</ul>
<h1 id="overview">Overview</h1>
<p>This sample reuses <code><a href="/animancer/api/Animancer.Samples.Basics/PlayAnimationOnEnable">PlayAnimationOnEnable</a></code> from the <a href="../../basics/quick-play">Quick Play</a> sample and has three new scripts:</p>
<ul>
<li><code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> inherits from <code>AnimancerJob</code> as a wrapper around the job to provide a clean API for other scripts to access the job.
<ul>
<li>The <code>Job</code> struct is nested inside the <code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> class and contains the actual <code>IAnimationJob</code> implementation.</li>
</ul>
</li>
<li><code><a href="/animancer/api/Animancer.Samples.Jobs/HitReceiver">HitReceiver</a></code> initializes and controls the <code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code>.</li>
<li><code><a href="/animancer/api/Animancer.Samples.Jobs/ClickToHit">ClickToHit</a></code> calls <code>HitReceiver.Hit</code> when the user clicks the mouse.</li>
</ul>
<p><a href="architecture.png"><img src="architecture.png" class="img-responsive" id="architecture"></a></p>
<h1 id="initialization">Initialization</h1>
<p><code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> inherits from <code>AnimancerJob</code> which is a simple base class that makes it a bit easier to manage Animation Jobs in Animancer.</p>
<pre><code class="language-cs">public class <a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a> : AnimancerJob&lt;<a href="/animancer/api/Animancer.Samples.Jobs/Job">SimpleLean.Job</a>&gt;, IDisposable
{
</code></pre>
<p>The constructor initializes the <a href="#job">Job</a> and passes it the required details as we have seen in the previous <a href="../">Animation Jobs</a> samples.</p>
<pre><code class="language-cs">    public SimpleLean(
        <a href="/animancer/api/Animancer/AnimancerGraph">AnimancerGraph</a> animancer,
        Vector3 axis,
        NativeArray&lt;TransformStreamHandle&gt; leanBones)
    {
        var animator = animancer.Component.Animator;

        _Job = new Job
        {
            root = animator.BindStreamTransform(animator.transform),
            bones = leanBones,
            axis = axis,
            angle = AnimancerUtilities.CreateNativeReference&lt;float&gt;(),// See the Angle section.
        };
</code></pre>
<p>The <code>CreatePlayable</code> method is inherited from <code>AnimancerJob</code>. It calls <code>AnimancerGraph.InsertOutputJob</code> like in the earlier samples, but it also stores the returned <code>AnimationScriptPlayable</code> for the <a href="#cleanup">Cleanup</a> process which also requires this object to be registered in the <code><a href="/animancer/api/Animancer/AnimancerGraph/263BB4F2">AnimancerGraph.Disposables</a></code> list.</p>
<pre><code class="language-cs">        CreatePlayable(animancer);

        animancer.Disposables.Add(this);
    }
</code></pre>
<h1 id="axis">Axis</h1>
<p>Since the <code>_Job</code> field (inherited from <code>AnimancerJob</code>) stores the job created in the constructor, we can just <code>get</code> the current <code>axis</code> directly from it.</p>
<pre><code class="language-cs">    public Vector3 Axis
    {
        get =&gt; _Job.axis;
</code></pre>
<p>But since the job is a <a href="/cs-unity/docs/introduction/organization#values-and-references">Value Type</a>, simply modifying the values stored in the <code>_Job</code> field will not actually modify the values of the job inside the <code>AnimationScriptPlayable</code> in the <code>PlayableGraph</code> so after we make any modifications we need to use <code>AnimationScriptPlayable.SetJobData</code> to give it the new data.</p>
<pre><code class="language-cs">        set
        {
            if (_Job.axis == value)
                return;

            _Job.axis = value;
            _Playable.SetJobData(_Job);
        }
    }
</code></pre>
<h1 id="angle">Angle</h1>
<p>Unlike the <a href="#axis">Axis</a>, the <code>Angle</code> of the lean will be changed very frequently so we want this property to be as efficient as possible. Even though jobs are not allowed to use reference types, we can exploit the fact that <code>NativeArray</code>s actually behave like reference types. By allocating a <code>NativeArray</code> with a size of <code>1</code> we will be able to efficiently access its value both inside and outside the job.</p>
<p>Inside the <code><a href="/animancer/api/Animancer.Samples.Jobs/Job">SimpleLean.Job</a></code> struct, we declare the <code>angle</code> field as a <code>NativeArray</code>.</p>
<pre><code class="language-cs">    public struct Job : IAnimationJob
    {
        ...
        public NativeArray&lt;float&gt; angle;
        ...
    }
</code></pre>
<p>Then when we initialize the <code>Job</code> in the <code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> constructor, we use <code>AnimancerUtilities.CreateNativeReference</code> to allocate a single element array for it.</p>
<pre><code class="language-cs">    public SimpleLean(
        <a href="/animancer/api/Animancer/AnimancerGraph">AnimancerGraph</a> animancer,
        Vector3 axis,
        NativeArray&lt;TransformStreamHandle&gt; leanBones)
    {
        ...
        _Job = new Job
        {
            ...
            angle = AnimancerUtilities.CreateNativeReference&lt;float&gt;(),
        };
        ...
    }
</code></pre>
<p>And that allows the <code>Angle</code> property to set the value without needing to use the <code>AnimationScriptPlayable.SetJobData</code> method to copy the entire <code>Job</code>.</p>
<pre><code class="language-cs">    public float Angle
    {
        get =&gt; _Job.angle[0];
        set =&gt; _Job.angle[0] = value;
    }
</code></pre>
<h1 id="cleanup">Cleanup</h1>
<p>As explained in the <a href="../damping#disposal">Damping</a> sample, when you're done with a <code>NativeArray</code> you must call <code>Dispose</code> on it to avoid leaking its memory. We could add the arrays directly to the <code><a href="/animancer/api/Animancer/AnimancerGraph/263BB4F2">AnimancerGraph.Disposables</a></code> list, but it might be useful to be able to remove the <code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> system separately from the destruction of the rest of the character and we don't want to let it cause an error if it tries to <code>Dispose</code> an array we already disposed.</p>
<p>We start by implementing the <code>IDisposable</code> interface with our own <code>Dispose</code> method.</p>
<pre><code class="language-cs">public class <a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a> : AnimancerJob&lt;<a href="/animancer/api/Animancer.Samples.Jobs/Job">SimpleLean.Job</a>&gt;, IDisposable
{
    public SimpleLean(...)
    {
        ...
        animancer.Disposables.Add(this);
    }

    public void Dispose()
    {
        if (_Job.angle.IsCreated)
            _Job.angle.Dispose();

        if (_Job.bones.IsCreated)
            _Job.bones.Dispose();
    }
</code></pre>
<p>That would take care of the automatic disposal, but if another script calls that <code>Dispose</code> method the <code>Job</code> would stop working without actually being removed from the <code>PlayableGraph</code> so it would still be executing and causing errors. So instead we can instead use an <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/interfaces/explicit-interface-implementation">Explicit Interface Implementation</a> and make the <code>Dispose</code> method private.</p>
<pre><code class="language-cs">    void IDisposable.Dispose() =&gt; Dispose();

    private void Dispose()
    {
        if (_Job.angle.IsCreated)
            _Job.angle.Dispose();

        if (_Job.bones.IsCreated)
            _Job.bones.Dispose();
    }
</code></pre>
<p>Then we override the <code>AnimancerJob.Destroy</code> method to call the <code>Dispose</code> method as well.</p>
<pre><code class="language-cs">    public override void Destroy()
    {
        Dispose();
        base.Destroy();
    }
</code></pre>
<p>So now the <code><a href="/animancer/api/Animancer/AnimancerGraph">AnimancerGraph</a></code> will call our <code>Dispose</code> method when the whole graph is being destroyed and other scripts can call that <code>Destroy</code> method which will both <code>Dispose</code> the job and remove it from the graph.</p>
<h1 id="job">Job</h1>
<p>The actual <code>Job</code> implementation is fairly simple. We already <a href="#initialization">initialized</a> the fields in the <code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> constructor.</p>
<pre><code class="language-cs">    public struct Job : IAnimationJob
    {
        public TransformStreamHandle root;
        public NativeArray&lt;TransformStreamHandle&gt; bones;
        public Vector3 axis;
        public NativeArray&lt;float&gt; angle;
</code></pre>
<p>The <code>IAnimationJob</code> interface contains two methods which are both called every time the <code>PlayableGraph</code> is updated (generally once per frame). We don't care about <code>ProcessRootMotion</code> here and want to do all our math in <code>ProcessAnimation</code>.</p>
<pre><code class="language-cs">        public void ProcessRootMotion(AnimationStream stream) { }

        public void ProcessAnimation(AnimationStream stream)
        {
</code></pre>
<p>We start by calculating the <code>angle</code> that each bone will be rotated by dividing the specified total <a href="#angle">Angle</a> by the number of bones. For this sample we're controlling the character's <em>Chest</em> and <em>Spine</em> bones, so each will receive half of the total angle.</p>
<pre><code class="language-cs">            var angle = this.angle[0] / bones.Length;
</code></pre>
<p>Since the <a href="#axis">Axis</a> is easier for other scripts to specify in local space, so we want to rotate that <code>axis</code> according to the character's <code>root</code>.</p>
<pre><code class="language-cs">            var worldAxis = root.GetRotation(stream) * axis;
</code></pre>
<p>Then we can use that <code>angle</code> and <code>worldAxis</code> to calculate the rotation <code>Quaternion</code> we want to add to each bone.</p>
<pre><code class="language-cs">            var offset = Quaternion.AngleAxis(angle, worldAxis);
</code></pre>
<p>And finally, we just add that <code>offset</code> to each of the <code>bones</code>.</p>
<pre><code class="language-cs">            for (int i = bones.Length - 1; i &gt;= 0; i--)
            {
                var bone = bones[i];
                bone.SetRotation(stream, offset * bone.GetRotation(stream));
            }
        }
    }
}
</code></pre>
<p>Note that "adding" rotations actually uses the multiply operator (<code>*</code>) due to the way <code>Quaternion</code> math works.</p>
<h1 id="hit-receiver">Hit Receiver</h1>
<p></p>
<table class="table">
  <thead>
    <tr><th style="width:50%">Code</th>
    <th style="width:50%">Inspector</th>
  </tr></thead>
  <tbody>
    <tr>
      <td>
<pre><code class="language-cs">public class <a href="/animancer/api/Animancer.Samples.Jobs/HitReceiver">HitReceiver</a> : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

    [SerializeField]
    private Transform[] _Bones;

    [SerializeField, Degrees]
    private float _MaximumAngle = 45;

    [SerializeField, Seconds]
    private float _SmoothingTime = 0.25f;

    private <a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a> _Lean;
    private float _Speed;
</code></pre>
</td>
      <td><p><img src="inspector.png" class="img-responsive"></p><code><a href="/animancer/api/Animancer.Samples.Jobs/HitReceiver">HitReceiver</a></code> is responsible for initializing and managing the <code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> to control the <em>Spine</em> and <em>Chest</em> bones.</td>
    </tr>
  </tbody>
</table>
<p>On startup, it asserts that at least one bone has been assigned, converts the <code>Transform[]</code> into a <code>NativeArray&lt;TransformStreamHandle&gt;</code> for the job to use, and creates the <code><a href="/animancer/api/Animancer.Samples.Jobs/SimpleLean">SimpleLean</a></code> with it.</p>
<pre><code class="language-cs">    protected virtual void Awake()
    {
        Debug.Assert(_Bones.Length &gt; 0, "No bones are assigned.", this);
        NativeArray&lt;TransformStreamHandle&gt; boneHandles =
            AnimancerUtilities.ConvertToTransformStreamHandles(_Bones, _Animancer.Animator);
        _Lean = new(_Animancer.Graph, Vector3.right, boneHandles);
    }
</code></pre>
<p>When it receives a hit, it uses a <code>Cross</code> product to set the <code>Axis</code> of rotation perpendicular to the hit direction and enables itself so it will start receiving <code>Update</code>s.</p>
<pre><code class="language-cs">    public void Hit(Vector3 direction, float force)
    {
        _Lean.Axis = Vector3.Cross(Vector3.up, direction).normalized;

        _Speed = force;

        enabled = true;
    }
</code></pre>
<p>Every <code>Update</code> it uses <code>Mathf.SmoothDamp</code> to move the rotation <code>Angle</code> towards <code>0</code>. Note how <code>Hit</code> set the <code>_Speed</code> which causes the value to move away from the target for a few frames as it decelerates before it can start moving back towards <code>0</code>.</p>
<pre><code class="language-cs">    protected virtual void Update()
    {
        float angle = Mathf.SmoothDamp(_Lean.Angle, 0, ref _Speed, _SmoothingTime);
        angle = Math.Min(angle, _MaximumAngle);
        _Lean.Angle = angle;
</code></pre>
<p>And when it finally settles at <code>0</code>, this script disables itself until it receives another <code>Hit</code>.</p>
<pre><code class="language-cs">        if (angle == 0 &amp;&amp; _Speed == 0)
            enabled = false;
    }
}
</code></pre>
<h1 id="click-to-hit">Click To Hit</h1>
<p>Since we don't have a proper system for hitting the character from a particular direction, <code><a href="/animancer/api/Animancer.Samples.Jobs/ClickToHit">ClickToHit</a></code> simply lets the user click on a point on the ground to simulate a hit to the character from that direction with a different amount of force for Left or Right Click.</p>
<pre><code class="language-cs">public class <a href="/animancer/api/Animancer.Samples.Jobs/ClickToHit">ClickToHit</a> : MonoBehaviour
{
    [SerializeField] private <a href="/animancer/api/Animancer.Samples.Jobs/HitReceiver">HitReceiver</a> _HitReceiver;
    [SerializeField] private float _LeftClickForce = 500;
    [SerializeField] private float _RightClickForce = 300;

    protected virtual void Update()
    {
        if (SampleInput.LeftMouseDown)
            HitTarget(_LeftClickForce);
        else if (SampleInput.RightMouseDown)
            HitTarget(_RightClickForce);
    }
</code></pre>
<p>It uses a <a href="https://docs.unity3d.com/ScriptReference/Physics.Raycast.html"><code>Physics.Raycast</code></a> to find the position on the ground where the mouse is pointing like in the <a href="../../mixers/directional#movement-direction">Directional Mixers</a> sample:</p>
<pre><code class="language-cs">    private void HitTarget(float force)
    {
        Ray ray = Camera.main.ScreenPointToRay(SampleInput.MousePosition);

        if (!Physics.Raycast(ray, out RaycastHit raycastHit))
            return;
</code></pre>
<p>Then it simply gets the direction from the ray hit position to the character and applies a <code>Hit</code> from that direction:</p>
<pre><code class="language-cs">        Vector3 direction = _HitReceiver.transform.position - raycastHit.point;
        _HitReceiver.Hit(direction, force);
    }
}
</code></pre>
<h1 id="conclusion">Conclusion</h1>
<p>This technique could be used for other things such as making a character lean to the side while running around a corner, turn and bend according to the direction they want to look, or even to widen the character's legs and arms to accomodate skinny or bulky characters without needing separate animations for each body type.</p>
<p><img src="hit-impacts.png" class="pngif img-responsive"></p>
<p>Using Animation Jobs for this allows the result to be entirely procedural without requiring any additional animations to be created, but the resulting motion is limited by its simplicity as you can see that it only affects the <em>Sping</em> and <em>Chest</em> bones while the rest of the upper body simply rotates rigidly. If you had animations for getting hit from each direction, you could use a <a href="../../../manual/blending/mixers">Directional Mixer</a> to blend them into a potentially better looking result.</p>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                <strong><div style="text-align:left; display:flex">

<div>
<p>Documentation</p>
<p><a href="/animancer/docs/samples">Samples</a></p>
<p><a href="/animancer/docs/manual">User Manual</a></p>
<p><a href="/animancer/docs/changes">Change Log</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Download</p>
<p><a href="https://kybernetik.itch.io/animancer-pro">Itch.io (Recommended)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-pro-116514?aid=1100l8ah5">Asset Store (Animancer Pro)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-lite-116516?aid=1100l8ah5">Asset Store (Animancer Lite)</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Contact</p>
<p><a href="https://github.com/KybernetikGames/animancer/issues">Github Issues</a></p>
<p><a href="/animancer/redirect/discussions">Unity Discussions</a></p>
<p><a href="mailto:animancer@kybernetik.com.au?subject=Animancer">Email</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Other Assets</p>
<p><a href="/flexi-motion">FlexiMotion</a></p>
<p><a href="/inspector-gadgets">Inspector Gadgets</a></p>
<p><a href="/weaver">Weaver</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>&nbsp;</p>
<p><a href="https://assetstore.unity.com/packages/vfx/shaders/simple-sun-shader-72042?aid=1100l8ah5">Simple Sun Shader</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/version-control/link-sync-229569?aid=1100l8ah5">Link &amp; Sync</a></p>
<p><a href="/ultevents">UltEvents</a></p>
</div>

</div></strong>
<script src="/animancer/assets/js/pngif.js"></script>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>