<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/animancer/v4-0/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/animancer/v4-0/assets/img/favicon.ico" type="image/x-icon">
        <title>Animancer - 01 Walk and Run</title>
        <link href="/animancer/v4-0/assets/css/highlight.css" rel="stylesheet">
        <link href="/animancer/v4-0/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/animancer/v4-0/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/animancer/v4-0/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/animancer/v4-0/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/animancer/v4-0/assets/css/override.css" rel="stylesheet">
        <script src="/animancer/v4-0/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/animancer/v4-0/assets/js/bootstrap.min.js"></script>        
        <script src="/animancer/v4-0/assets/js/app.min.js"></script>         
        <script src="/animancer/v4-0/assets/js/highlight.pack.js"></script>   
        <script src="/animancer/v4-0/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/animancer/v4-0/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/animancer/v4-0/assets/js/mermaid.min.js"></script>
        <script src="/animancer/v4-0/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/animancer/v4-0/assets/js/html5shiv.min.js"></script>
        <script src="/animancer/v4-0/assets/js/respond.min.js"></script>
        <![endif]-->  

        
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/animancer/v4-0/" class="logo">
                            <span>Animancer</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li class="active"><a href="/animancer/v4-0/docs"><img src="/animancer/v4-0/images/docs.png" height="20" style="position:relative; left:-5px; top:-1px;"> Docs</a></li>
        <li><a href="/animancer/v4-0/docs/help"><img src="/animancer/v4-0/images/help.png" height="20" style="position:relative; left:-4px; top:-1px;"> Help</a></li>
        <li><a href="/animancer/v4-0/api/Animancer/AnimancerComponent"><img src="/animancer/v4-0/images/api.png" height="20" style="position:relative; left:-3px; top:-1px;"> API v4.0</a></li>
        <li><a href="/animancer/lite"><img src="/animancer/v4-0/images/unity-logo.png" height="20" style="position:relative; left:-4px; top:-1px;"> Try</a></li>
        <li><a href="/animancer/pro"><img src="/animancer/v4-0/images/unity-logo.png" height="20" style="position:relative; left:-4px; top:-1px;"> Buy</a></li>
        <li><a href="https://kybernetik.com.au/kailas-dierk/unity-assets"><img src="/animancer/v4-0/images/kybernetik.png" height="20" style="position:relative; left:-2px; top:-1px;"> Other Assets</a></li>
 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
<a href="/animancer" style="font-size:1.42em; color:white">This is the <strong>Animancer v4.0 Beta</strong> Documentation. Click Here to return to the v3.1 Documentation.</a>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#simple-movement">Simple Movement</a></p>
<p><a href="#adding-run">Adding Run</a></p>
<p><a href="#synchronising-the-transition">Synchronising the Transition</a></p>
<p><a href="#cycle-offset">Cycle Offset</a></p>
<p><a href="#going-backwards">Going Backwards</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li><a href="/animancer/v4-0/docs/help">Help and FAQ</a></li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/introduction">Introduction</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/introduction/features">Features</a></li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/introduction/mecanim-vs-animancer">Mecanim vs. Animancer</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/introduction/mecanim-vs-animancer/why-replace-mecanim">Why Replace Mecanim?</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/mecanim-vs-animancer/playing">Playing</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/mecanim-vs-animancer/waiting">Waiting</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/mecanim-vs-animancer/speed-and-time">Speed and Time</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/mecanim-vs-animancer/weapon-animations">Weapon Animations</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/mecanim-vs-animancer/performance">Performance</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v4-0/docs/introduction/glossary">Glossary</a></li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/introduction/cs">C# in Unity</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/introduction/cs/overview">Scripting Overview</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/cs/organisation">Organisation</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/cs/variables">Variables</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/cs/methods">Methods</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/cs/inheritance">Inheritance</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/cs/vectors">Vectors</a></li>
                <li><a href="/animancer/v4-0/docs/introduction/cs/other">Other Topics</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/v4-0/docs/examples">Examples</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/basics">01 Basics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/basics/scene-setup">Basic Scene Setup</a></li>
                <li><a href="/animancer/v4-0/docs/examples/basics/quick-play">01 Quick Play</a></li>
                <li><a href="/animancer/v4-0/docs/examples/basics/playing-and-fading">02 Playing and Fading</a></li>
                <li><a href="/animancer/v4-0/docs/examples/basics/sequence-coroutine">03 Sequence Coroutine</a></li>
                <li><a href="/animancer/v4-0/docs/examples/basics/named-animations">04 Named Animations</a></li>
                <li><a href="/animancer/v4-0/docs/examples/basics/hybrid">05 Hybrid Basics</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/fine-control">02 Fine Control</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/fine-control/spider-bot">01 Spider Bot</a></li>
                <li><a href="/animancer/v4-0/docs/examples/fine-control/doors">02 Doors</a></li>
                <li><a href="/animancer/v4-0/docs/examples/fine-control/solo-animation">03 Solo Animation</a></li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/v4-0/docs/examples/locomotion">03 Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="selected"><a href="/animancer/v4-0/docs/examples/locomotion/walk-and-run">01 Walk and Run</a></li>
                <li><a href="/animancer/v4-0/docs/examples/locomotion/root-motion">02 Root Motion</a></li>
                <li><a href="/animancer/v4-0/docs/examples/locomotion/linear-blending">03 Linear Blending</a></li>
                <li><a href="/animancer/v4-0/docs/examples/locomotion/directional-blending">04 Directional Blending</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/directional-sprites">04 Directional Sprites</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/directional-sprites/basic-movement">01 Basic Movement</a></li>
                <li><a href="/animancer/v4-0/docs/examples/directional-sprites/character-controller">02 Character Controller</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/events">05 Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/events/footstep-events">01 Footstep Events</a></li>
                <li><a href="/animancer/v4-0/docs/examples/events/golf-events">02 Golf Events</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/fsm">06 State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/fsm/creatures">01 Creatures</a></li>
                <li><a href="/animancer/v4-0/docs/examples/fsm/interrupt-management">02 Interrupt Management</a></li>
                <li><a href="/animancer/v4-0/docs/examples/fsm/brains">03 Brains</a></li>
                <li><a href="/animancer/v4-0/docs/examples/fsm/more-brains">04 More Brains</a></li>
                <li><a href="/animancer/v4-0/docs/examples/fsm/platformer">05 Platformer</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v4-0/docs/examples/layers">07 Layers</a></li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/ik">08 Inverse Kinematics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/ik/puppet">01 Puppet</a></li>
                <li><a href="/animancer/v4-0/docs/examples/ik/uneven-ground">02 Uneven Ground</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/animator-controllers">09 Animator Controllers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/hybrid">01 Hybrid Mini Game</a></li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit">02 3D Game Kit</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/problems">Problems with the Original</a></li>
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/respawn">Respawn</a></li>
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/idle">Idle</a></li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/locomotion">Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/locomotion/movement">Movement</a></li>
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/locomotion/turning">Turning</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/airborne">Airborne</a></li>
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/landing">Landing</a></li>
                <li><a href="/animancer/v4-0/docs/examples/animator-controllers/3d-game-kit/attack">Attack</a></li>

                    </ul>
                </li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/manual">User Manual</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/manual/playing">Playing Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/manual/playing/states">States</a></li>
                <li><a href="/animancer/v4-0/docs/manual/playing/inspector">Inspector</a></li>
                <li><a href="/animancer/v4-0/docs/manual/playing/component-types">Component Types</a></li>
                <li><a href="/animancer/v4-0/docs/manual/playing/directional-sets">Directional Animation Sets</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/manual/transitions">Transitions</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/manual/transitions/types">Transition Types</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/manual/blending">Blending</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/manual/blending/fading">Fading</a></li>
                <li><a href="/animancer/v4-0/docs/manual/blending/layers">Layers</a></li>
                <li><a href="/animancer/v4-0/docs/manual/blending/mixers">Mixers</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/manual/events">Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/manual/events/animation">Animation Events</a></li>
                <li><a href="/animancer/v4-0/docs/manual/events/animancer">Animancer Events</a></li>
                <li><a href="/animancer/v4-0/docs/manual/events/end">End Events</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v4-0/docs/manual/fsm">Finite State Machines</a></li>
                <li><a href="/animancer/v4-0/docs/manual/animator-controllers">Animator Controllers</a></li>
                <li><a href="/animancer/v4-0/docs/manual/ik">Inverse Kinematics</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/bugs">Unity Bugs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/bugs/inconsistent-timing">Inconsistent Timing</a></li>
                <li><a href="/animancer/v4-0/docs/bugs/paused-skinned-mesh-update">Paused Skinned Mesh Update</a></li>
                <li><a href="/animancer/v4-0/docs/bugs/resetting-animated-values">Resetting Animated Values</a></li>
                <li><a href="/animancer/v4-0/docs/bugs/unused-graph-destroy-warning">Unused Graph Destroy Warning</a></li>
                <li><a href="/animancer/v4-0/docs/bugs/update-modes">Update Modes</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/source">Source Code</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/source/dlls">DLLs</a></li>
                <li><a href="/animancer/v4-0/docs/source/creating-custom-states">Creating Custom States</a></li>
                <li><a href="/animancer/v4-0/docs/source/graph-structure">Graph Structure</a></li>
                <li><a href="/animancer/v4-0/docs/source/asset-sources">Asset Sources</a></li>
                <li><a href="/animancer/v4-0/docs/source/coding-standard">Coding Standard</a></li>
                <li><a href="/animancer/v4-0/docs/source/default-script-template">Default Script Template</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v4-0/docs/changes">Change Log</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v4-0/docs/changes/animancer-v4-0-beta">Beta Test v4.0</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v4-0">Progress of v4.0</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v3-1">Animancer v3.1</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v3-0">Animancer v3.0</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v2-0">Animancer v2.0</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v1-3">Animancer v1.3</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v1-2">Animancer v1.2</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v1-1">Animancer v1.1</a></li>
                <li><a href="/animancer/v4-0/docs/changes/animancer-v1-0">Animancer v1.0</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>01 Walk and Run</h1>
		</section>
	<section class="content">
		<blockquote class="blockquote">
<p><strong>Difficulty</strong>: <a href="../../../introduction/glossary#example-difficulty">Beginner</a></p>
<p><strong>Location</strong>: <em>Assets/Plugins/Animancer/Examples/03 Locomotion/01 Walk and Run</em></p>
<p><strong>Namespace</strong>: <a href="../../../../api/Animancer.Examples.Locomotion"><code>Animancer.Examples.Locomotion</code></a></p>
</blockquote>
<p>This example demonstrates a simple script which plays a <em>Walk</em> animation while you hold down a key and then extends that with another script which can also play a <em>Run</em> animation if you hold down a different key at the same time. It also ensures that those animations remain in sync when blending between them so that the transition looks natural.</p>
<p><em><a href="../../../introduction/features"><strong>Pro-Only Features</strong></a> are used in this example: modifying <code>AnimancerState.Speed</code> and <code><a href="/animancer/v4-0/api/Animancer/AnimancerState/617EFC91">AnimancerState.NormalizedTime</a></code>. Animancer Lite allows you to try out these features in the Unity Editor, but they are not available in runtime builds unless you purchase <a href="/animancer/pro">Animancer Pro</a>.</em></p>
<p><img src="walk-and-run.gif" class="img-responsive"></p>
<p></p><details><summary>The character on the right uses the <code><a href="/animancer/v4-0/api/Animancer.Examples.Locomotion/IdleAndWalk">IdleAndWalk</a></code> script which looks like this (with the comments removed since we are about to explain how it works):</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public class <a href="/animancer/v4-0/api/Animancer.Examples.Locomotion/IdleAndWalk">IdleAndWalk</a> : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;
    public <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> Animancer { get { return _Animancer; } }

    [SerializeField]
    private AnimationClip _Idle;
    public AnimationClip Idle { get { return _Idle; } }

    [SerializeField]
    private AnimationClip _Walk;
    public AnimationClip Walk { get { return _Walk; } }

    protected void Update()
    {
        var movement = Input.GetAxisRaw("Vertical");
        if (movement != 0)
        {
            PlayMove();

            _Animancer.States.Current.Speed = movement;
        }
        else
        {
            _Animancer.Play(_Idle, 0.25f);
        }
    }

    protected virtual void PlayMove()
    {
        _Animancer.Play(_Walk, 0.25f);
    }

    protected virtual void Reset()
    {
        AnimancerUtilities.IfMultiComponentThenChangeType(this);
    }
}
</code></pre>
<p></p></details><p></p>
<p></p><details><summary>And the character on the left uses the <code><a href="/animancer/v4-0/api/Animancer.Examples.Locomotion/IdleAndWalkAndRun">IdleAndWalkAndRun</a></code> script which looks like this (with the comments removed since we are about to explain how it works):</summary><p>
</p><p>Note how it <a href="../../../introduction/cs/inheritance">Inherits</a> from <code><a href="/animancer/v4-0/api/Animancer.Examples.Locomotion/IdleAndWalk">IdleAndWalk</a></code> instead of the usual <code>MonoBehaviour</code>.</p>
<pre><code class="language-cs">using Animancer;
using UnityEngine;

public class <a href="/animancer/v4-0/api/Animancer.Examples.Locomotion/IdleAndWalkAndRun">IdleAndWalkAndRun</a> : <a href="/animancer/v4-0/api/Animancer.Examples.Locomotion/IdleAndWalk">IdleAndWalk</a>
{
    [SerializeField] private AnimationClip _Run;

    protected override void PlayMove()
    {
        AnimationClip playAnimation, otherAnimation;

        if (Input.GetKey(KeyCode.LeftShift))
        {
            playAnimation = _Run;
            otherAnimation = Walk;
        }
        else
        {
            playAnimation = Walk;
            otherAnimation = _Run;
        }

        var playState = Animancer.Play(playAnimation, 0.25f);

        var otherState = Animancer.GetState(otherAnimation);
        if (otherState != null &amp;&amp; otherState.IsPlaying)
            playState.NormalizedTime = otherState.NormalizedTime;
    }
}
</code></pre>
<p></p></details><p></p>
<h1 id="simple-movement">Simple Movement</h1>
<p>Implementing a script that will play a <em>Walk</em> animation while you hold a key and return to <em>Idle</em> when you release it is very easy using the concepts introduced in the <a href="../../basics/quick-play">Quick Play</a> example.</p>
<pre><code class="language-cs">using Animancer;
using UnityEngine;

public sealed class IdleAndWalkTutorial : MonoBehaviour
{
    [SerializeField] private <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;
    [SerializeField] private AnimationClip _Idle;
    [SerializeField] private AnimationClip _Walk;

    private void Update()
    {
        var movement = Input.GetAxisRaw("Vertical");
        if (movement &gt; 0)
        {
            _Animancer.Play(_Walk, 0.25f);
        }
        else
        {
            _Animancer.Play(_Idle, 0.25f);
        }
    }
}
</code></pre>
<p>The <code>"Vertical"</code> input axis will return <code>1</code> when <code>W</code> or <code>UpArrow</code> is held or <code>-1</code> when <code>S</code> or <code>DownArrow</code> is held. We only care about positive values for now.</p>
<p><img src="simple-movement.gif" class="img-responsive"></p>
<h1 id="adding-run">Adding Run</h1>
<p>The <code>IdleAndWalkTutorial</code> script is not very extensible yet, but with a few changes we can easily allow another script to <a href="../../../introduction/cs/inheritance">Inherit</a> from it to add a <em>Run</em> animation.</p>
<p>First we need to remove the <a href="../../../introduction/cs/inheritance#keywords"><code>sealed</code></a> keyword from the class and change the <code>Update</code> method to <a href="../../../introduction/cs/organisation#access-modifiers"><code>protected</code></a>. The <a href="../../../source/default-script-template#why-sealed">Default Script Template</a> page explains why we made it <a href="../../../introduction/cs/inheritance#keywords"><code>sealed</code></a> by default.</p>
<p>The derived class will need access to the <code><a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a></code> and <code>_Walk</code> animation so let's add <a href="../../../introduction/cs/organisation#access-modifiers"><code>public</code></a> read-only <a href="../../../introduction/cs/methods#properties">Properties</a> for them (we could make the fields <a href="../../../introduction/cs/organisation#access-modifiers"><code>protected</code></a>, but we do not particularly want the derived class to be able to change their values). For the sake of completeness we might as well add one for the <code>_Idle</code> animation as well even though we do not intend to use it.</p>
<pre><code class="language-cs">// These properties are read-only because they have "get" but not "set".
public <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> Animancer { get { return _Animancer; } }
public AnimationClip Idle { get { return _Idle; } }
public AnimationClip Walk { get { return _Walk; } }
</code></pre>
<p>The last thing we need to be able to do is change the behaviour when you are moving. We could make the <code>Update</code> method <a href="../../../introduction/cs/inheritance#keywords"><code>virtual</code></a>, but all we actually want to change is the <code>Play(_Walk, 0.25f)</code> to choose between <em>Walk</em> or <em>Run</em> so we only need to move that part out to a <a href="../../../introduction/cs/inheritance#keywords"><code>virtual</code></a> method.</p>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public class IdleAndWalkTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;
    public <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> Animancer { get { return _Animancer; } }

    [SerializeField]
    private AnimationClip _Idle;
    public AnimationClip Idle { get { return _Idle; } }

    [SerializeField]
    private AnimationClip _Walk;
    public AnimationClip Walk { get { return _Walk; } }

    protected void Update()
    {
        var movement = Input.GetAxisRaw("Vertical");
        if (movement &gt; 0)
        {
            PlayMove();
        }
        else
        {
            _Animancer.Play(_Idle, 0.25f);
        }
    }

    protected virtual void PlayMove()
    {
        _Animancer.Play(_Walk, 0.25f);
    }
}
</code></pre>
<p></p></details><p></p>
<p>It still has the same behaviour, but now we can make another script called <code>IdleAndWalkAndRunTutorial</code> to <a href="../../../introduction/cs/inheritance">Inherit</a> from it and <a href="../../../introduction/cs/inheritance#keywords"><code>override</code></a> the <code>PlayMove</code> method to choose between <em>Walk</em> or <em>Run</em> based on whether the user is holding the <code>"Fire3"</code> button (Left Shift by default):</p>
<pre><code class="language-cs">using UnityEngine;

public class IdleAndWalkAndRunTutorial : IdleAndWalkTutorial
{
    [SerializeField] private AnimationClip _Run;

    protected override void PlayMove()
    {
        var animation = Input.GetButton("Fire3") ? _Run : Walk;
        Animancer.Play(animation, 0.25f);
    }
}
</code></pre>
<p>We could now remove the <code>IdleAndWalkTutorial</code> component from the character and add our new <code>IdleAndWalkAndRunTutorial</code> instead, but then we would need to reassign all the references. Right now that's only 3 fields and we only need to do it once, but in a more complex system that could become quite tedious if we frequently needed to swap between similar components. Fortunately Animancer has a simple solution to the problem: all we have to do is add this method to the base <code>IdleAndWalkTutorial</code> class:</p>
<pre><code class="language-cs">// Reset is called when we add a new component in Edit Mode.
protected virtual void Reset()
{
    // If there is already a component that inherits from IdleAndWalkTutorial,
    // change the type of that component and destroy this new one immediately.
    AnimancerUtilities.IfMultiComponentThenChangeType(this);
}
</code></pre>
<p>Then we can just use the <em>Add Component</em> menu to add a <code>IdleAndWalkAndRunTutorial</code> component to the same object as the base <code>IdleAndWalkTutorial</code> and it will change the type of the existing component instead of adding the new one separately.</p>
<p>And once we assign the <em>Run</em> animation in the Inspector, we get a character that can <em>Idle</em>, <em>Walk</em>, and <em>Run</em>.</p>
<p><img src="walk-run-basic.gif" class="img-responsive"></p>
<h1 id="synchronising-the-transition">Synchronising the Transition</h1>
<p>We now have a functional script, but the transition between <em>Walk</em> and <em>Run</em> isn't quite perfect. Each time we start running is starts at the beginning of that animation, regardless of where we are at in the walk cycle so if you watch the arms or legs closely you can sometimes see an unnatural change in direction during the transition. Fortunately this is easy to solve by synchronising their <code>NormalizedTime</code>s during the transition since both animations contain exactly one walk cycle (one step with each leg). If you want this synchronisation to be performed automatically, you can use <a href="../../../manual/blending/mixers">Mixers</a> or <a href="https://docs.unity3d.com/Manual/class-BlendTree.html">Blend Trees</a> which are both demonstrated in the <a href="../linear-blending">Linear Blending</a> example.</p>
<p>Note that manipulating the <code>NormalizedTime</code> requires Animancer Pro (Animancer Lite allows you to try it out in the Unity Editor, but it will do nothing in runtime builds).</p>
<p>First we need to get both animations: the one we are trying to play and the other one:</p>
<pre><code class="language-cs">AnimationClip playAnimation, otherAnimation;

if (Input.GetButton("Fire3"))
{
    playAnimation = _Run;
    otherAnimation = Walk;
}
else
{
    playAnimation = Walk;
    otherAnimation = _Run;
}
</code></pre>
<p>Then we play the animation we want like before, but now we grab its <code><a href="/animancer/v4-0/api/Animancer/AnimancerState">AnimancerState</a></code>:</p>
<pre><code class="language-cs">var playState = Animancer.Play(playAnimation, 0.25f);
</code></pre>
<p>Then we get the other animation's state and if it's still playing (because it hasn't finished fading out) we give its <code>NormalizedTime</code> to the animation we just started playing:</p>
<pre><code class="language-cs">var otherState = Animancer.GetState(otherAnimation);
if (otherState != null &amp;&amp; otherState.IsPlaying)
    playState.NormalizedTime = otherState.NormalizedTime;
</code></pre>
<p><a href="../../../manual/blending/mixers">Mixers</a> and Blend Trees can automatically perform this synchronisation as demonstrated in the <a href="../linear-blending">Linear Blending</a> example.</p>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using UnityEngine;

public class IdleAndWalkAndRunTutorial : IdleAndWalkTutorial
{
    [SerializeField] private AnimationClip _Run;

    protected override void PlayMove()
    {
        AnimationClip playAnimation, otherAnimation;

        if (Input.GetButton("Fire3"))
        {
            playAnimation = _Run;
            otherAnimation = Walk;
        }
        else
        {
            playAnimation = Walk;
            otherAnimation = _Run;
        }

        var playState = Animancer.Play(playAnimation, 0.25f);

        var otherState = Animancer.GetState(otherAnimation);
        if (otherState != null &amp;&amp; otherState.IsPlaying)
            playState.NormalizedTime = otherState.NormalizedTime;
    }
}
</code></pre>
<p></p></details><p></p>
<p>Which gives us much nicer transitions at any point in the walk cycle:</p>
<p><img src="walk-run-sync.gif" class="img-responsive"></p>
<h1 id="cycle-offset">Cycle Offset</h1>
<p>Setting up that synchronisation was so easy because both animations use the same walk cycle. They start just as the left foot touches down and last for one step with each leg.</p>
<p>However, that was not originally true. The <em>Run</em> animation actually starts as the right foot touches down, but if you select it you can see that its <code>Cycle Offset</code> value is set to <code>0.5</code>. This means that when it plays, the animation's <code>Time = 0</code> start point is actually halfway through the animation data and we can adjust it easily without needing to edit the animation itself just to line up the walk cycles.</p>
<p>If want to try setting the <code>Cycle Offset</code> to 0, you will find that the simple synchronisation we just implemented guarantees that the transition will look as bad as possible because it is adjusting the time to the exact opposite point in the cycle to where we want it. Remember to set the value back to 0.5 if you try this.</p>
<h1 id="going-backwards">Going Backwards</h1>
<p>We do not have dedicated animations for walking or running backwards, but if we set the <code>Speed</code> to -1 to play the existing animations backwards we can get a somewhat acceptable result. This only requires two simple modifications to the base <code>IdleAndWalkTutorial</code> script:</p>
<ol>
<li>Change <code>if (movement &gt; 0)</code> to <code>if (movement != 0)</code>.</li>
<li>Add <code>_Animancer.CurrentState.Speed = movement;</code> after <code>PlayMove();</code>.</li>
</ol>
<p>That will call <code>PlayMove</code> when holding backwards as well as forwards and whatever it just played will be the <code>_Animancer.CurrentState</code> so we set its speed accordingly.</p>
<p>Note that manipulating the <code>Speed</code> requires Animancer Pro (Animancer Lite allows you to try it out in the Unity Editor, but it will do nothing in runtime builds).</p>
<p></p><details><summary>The full script now looks like this:</summary><p>
</p><pre><code class="language-cs">using Animancer;
using UnityEngine;

public class IdleAndWalkTutorial : MonoBehaviour
{
    [SerializeField]
    private <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;
    public <a href="/animancer/v4-0/api/Animancer/AnimancerComponent">AnimancerComponent</a> Animancer { get { return _Animancer; } }

    [SerializeField]
    private AnimationClip _Idle;
    public AnimationClip Idle { get { return _Idle; } }

    [SerializeField]
    private AnimationClip _Walk;
    public AnimationClip Walk { get { return _Walk; } }

    protected void Update()
    {
        var movement = Input.GetAxisRaw("Vertical");
        if (movement != 0)
        {
            PlayMove();
            _Animancer.CurrentState.Speed = movement;
        }
        else
        {
            _Animancer.Play(_Idle, 0.25f);
        }
    }

    protected virtual void PlayMove()
    {
        _Animancer.Play(_Walk, 0.25f);
    }

    protected virtual void Reset()
    {
        AnimancerUtilities.IfMultiComponentThenChangeType(this);
    }
}
</code></pre>
<p></p></details><p></p>
<p><img src="walk-run-backwards.gif" class="img-responsive"></p>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                Generated by <a href="https://wyam.io">Wyam</a>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>