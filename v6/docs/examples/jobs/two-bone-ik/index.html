<!DOCTYPE html><html><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="description">
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/animancer/v6/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/animancer/v6/assets/img/favicon.ico" type="image/x-icon">
        <title>Animancer - 01 Two Bone IK</title>
        <link href="/animancer/v6/assets/css/highlight.css" rel="stylesheet">
        <link href="/animancer/v6/assets/css/bootstrap/bootstrap.css" rel="stylesheet">
        <link href="/animancer/v6/assets/css/adminlte/AdminLTE.css" rel="stylesheet">
        <link href="/animancer/v6/assets/css/theme/theme.css" rel="stylesheet">
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/animancer/v6/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/animancer/v6/assets/css/override.css" rel="stylesheet">
        <script src="/animancer/v6/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/animancer/v6/assets/js/bootstrap.min.js"></script>        
        <script src="/animancer/v6/assets/js/app.min.js"></script>         
        <script src="/animancer/v6/assets/js/highlight.pack.js"></script>   
        <script src="/animancer/v6/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/animancer/v6/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/animancer/v6/assets/js/mermaid.min.js"></script>
        <script src="/animancer/v6/assets/js/svg-pan-zoom.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/animancer/v6/assets/js/html5shiv.min.js"></script>
        <script src="/animancer/v6/assets/js/respond.min.js"></script>
        <![endif]-->  

        
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/animancer/v6/" class="logo">
                            <span>Animancer</span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li><a href="/animancer/v6/docs/introduction/features"><img src="/animancer/v6/images/features.png" height="20" style="position:relative; left:-7px; top:-1px;"> Features</a></li>
        <li><a href="/animancer/v6/docs/download"><img src="/animancer/v6/images/download.png" height="20" style="position:relative; left:-7px; top:-1px;"> Download</a></li>
        <li class="active"><a href="/animancer/v6/docs"><img src="/animancer/v6/images/docs.png" height="20" style="position:relative; left:-5px; top:-1px;"> Documentation</a></li>
        <li><a href="/animancer/v6/docs/help"><img src="/animancer/v6/images/help.png" height="20" style="position:relative; left:-4px; top:-1px;"> Help</a></li>
        <li><a href="/animancer/v6/api/Animancer/AnimancerComponent"><img src="/animancer/v6/images/api.png" height="20" style="position:relative; left:-3px; top:-1px;"> API v6.0</a></li>
        <li><a href="https://kybernetik.com.au/kailas-dierk/unity-assets"><img src="/animancer/v6/images/kybernetik.png" height="20" style="position:relative; left:-2px; top:-1px;"> Other Assets</a></li>
 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
<a href="/animancer" style="font-size:1.42em; color:white">This is the <strong>Animancer v6.0 Preview</strong> Documentation. Click Here to return to the v5.3 Documentation.</a>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
    <div id="infobar-headings"><h6>On This Page</h6><p><a href="#scripts">Scripts</a></p>
<p><a href="#responsibilities">Responsibilities</a></p>
<p><a href="#fields">Fields</a></p>
<p><a href="#initialisation">Initialisation</a></p>
<p><a href="#conclusion">Conclusion</a></p>
<hr class="infobar-hidden">
</div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

                <li><a href="/animancer/v6/docs/download">Download</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/introduction">Introduction</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/introduction/features">Features</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/introduction/mecanim-vs-animancer">Mecanim vs. Animancer</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/introduction/mecanim-vs-animancer/why">Why Replace Mecanim?</a></li>
                <li><a href="/animancer/v6/docs/introduction/mecanim-vs-animancer/playing">Playing</a></li>
                <li><a href="/animancer/v6/docs/introduction/mecanim-vs-animancer/waiting">Waiting</a></li>
                <li><a href="/animancer/v6/docs/introduction/mecanim-vs-animancer/speed-and-time">Speed and Time</a></li>
                <li><a href="/animancer/v6/docs/introduction/mecanim-vs-animancer/weapon-animations">Weapon Animations</a></li>
                <li><a href="/animancer/v6/docs/introduction/mecanim-vs-animancer/performance">Performance</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v6/docs/introduction/glossary">Glossary</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/introduction/cs">C# in Unity</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/introduction/cs/overview">Scripting Overview</a></li>
                <li><a href="/animancer/v6/docs/introduction/cs/organisation">Organisation</a></li>
                <li><a href="/animancer/v6/docs/introduction/cs/variables">Variables</a></li>
                <li><a href="/animancer/v6/docs/introduction/cs/methods">Methods</a></li>
                <li><a href="/animancer/v6/docs/introduction/cs/inheritance">Inheritance</a></li>
                <li><a href="/animancer/v6/docs/introduction/cs/vectors">Vectors</a></li>
                <li><a href="/animancer/v6/docs/introduction/cs/other">Other Topics</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/v6/docs/examples">Examples</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/basics">01 Basics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/basics/scene-setup">Basic Scene Setup</a></li>
                <li><a href="/animancer/v6/docs/examples/basics/quick-play">01 Quick Play</a></li>
                <li><a href="/animancer/v6/docs/examples/basics/playing-and-fading">02 Playing and Fading</a></li>
                <li><a href="/animancer/v6/docs/examples/basics/sequence-coroutine">03 Sequence Coroutine</a></li>
                <li><a href="/animancer/v6/docs/examples/basics/named-animations">04 Named Animations</a></li>
                <li><a href="/animancer/v6/docs/examples/basics/hybrid">05 Hybrid Basics</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/fine-control">02 Fine Control</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/fine-control/spider-bot">01 Spider Bot</a></li>
                <li><a href="/animancer/v6/docs/examples/fine-control/doors">02 Doors</a></li>
                <li><a href="/animancer/v6/docs/examples/fine-control/solo-animation">03 Solo Animation</a></li>
                <li><a href="/animancer/v6/docs/examples/fine-control/update-rate">04 Update Rate</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/locomotion">03 Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/locomotion/walk-and-run">01 Walk and Run</a></li>
                <li><a href="/animancer/v6/docs/examples/locomotion/root-motion">02 Root Motion</a></li>
                <li><a href="/animancer/v6/docs/examples/locomotion/linear-blending">03 Linear Blending</a></li>
                <li><a href="/animancer/v6/docs/examples/locomotion/directional-blending">04 Directional Blending</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/directional-sprites">04 Directional Sprites</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/directional-sprites/basic-movement">01 Basic Movement</a></li>
                <li><a href="/animancer/v6/docs/examples/directional-sprites/character-controller">02 Character Controller</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/events">05 Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/events/footsteps">01 Footstep Events</a></li>
                <li><a href="/animancer/v6/docs/examples/events/golf">02 Golf Events</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/fsm">06 State Machines</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/fsm/game-manager">01 Game Manager</a></li>
                <li><a href="/animancer/v6/docs/examples/fsm/creatures">02 Creatures</a></li>
                <li><a href="/animancer/v6/docs/examples/fsm/interrupts">03 Interrupt Management</a></li>
                <li><a href="/animancer/v6/docs/examples/fsm/brains">04 Brains</a></li>
                <li><a href="/animancer/v6/docs/examples/fsm/more-brains">05 More Brains</a></li>
                <li><a href="/animancer/v6/docs/examples/fsm/weapons">06 Weapons</a></li>
                <li><a href="/animancer/v6/docs/examples/fsm/platformer">07 Platformer</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v6/docs/examples/layers">07 Layers</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/ik">08 Inverse Kinematics</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/ik/puppet">01 Puppet</a></li>
                <li><a href="/animancer/v6/docs/examples/ik/uneven-ground">02 Uneven Ground</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/animator-controllers">09 Animator Controllers</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/animator-controllers/hybrid">01 Hybrid Mini Game</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit">02 3D Game Kit</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/problems">Problems with the Mecanim Character</a></li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/respawn">Respawn</a></li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/idle">Idle</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/locomotion">Locomotion</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/locomotion/movement">Movement</a></li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/locomotion/turning">Turning</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/airborne">Airborne</a></li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/landing">Landing</a></li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/attack">Attack</a></li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/flinch">Flinch</a></li>
                <li><a href="/animancer/v6/docs/examples/animator-controllers/3d-game-kit/die">Die</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview active">
                    <a href="/animancer/v6/docs/examples/jobs">10 Animation Jobs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="selected"><a href="/animancer/v6/docs/examples/jobs/two-bone-ik">01 Two Bone IK</a></li>
                <li><a href="/animancer/v6/docs/examples/jobs/damping">02 Damping</a></li>
                <li><a href="/animancer/v6/docs/examples/jobs/lean">03 Lean</a></li>

                    </ul>
                </li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/manual">User Manual</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/v6/docs/manual/getting">Getting Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/manual/getting/mixamo">Mixamo</a></li>
                <li><a href="/animancer/v6/docs/manual/getting/importing">Importing</a></li>
                <li><a href="/animancer/v6/docs/manual/getting/sprites">Sprites</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/manual/playing">Playing Animations</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/manual/playing/states">States</a></li>
                <li><a href="/animancer/v6/docs/manual/playing/inspector">Inspector</a></li>
                <li><a href="/animancer/v6/docs/manual/playing/component-types">Component Types</a></li>
                <li><a href="/animancer/v6/docs/manual/playing/directional-sets">Directional Animation Sets</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/manual/transitions">Transitions</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/manual/transitions/types">Transition Types</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/manual/blending">Blending</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/manual/blending/fading">Fading</a></li>
                <li><a href="/animancer/v6/docs/manual/blending/layers">Layers</a></li>
                <li><a href="/animancer/v6/docs/manual/blending/mixers">Mixers</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/manual/events">Events</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/manual/events/animation">Animation Events</a></li>
                <li><a href="/animancer/v6/docs/manual/events/animancer">Animancer Events</a></li>
                <li><a href="/animancer/v6/docs/manual/events/end">End Events</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v6/docs/manual/fsm">Finite State Machines</a></li>
                <li><a href="/animancer/v6/docs/manual/animator-controllers">Animator Controllers</a></li>
                <li><a href="/animancer/v6/docs/manual/timeline">Timeline</a></li>
                <li><a href="/animancer/v6/docs/manual/ik">Inverse Kinematics</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/bugs">Unity Bugs</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/bugs/events">Animation Events</a></li>
                <li><a href="/animancer/v6/docs/bugs/paused-skinned-mesh-update">Paused Skinned Mesh Update</a></li>
                <li><a href="/animancer/v6/docs/bugs/serialized-array-initialization">Serialized Array Initialization</a></li>
                <li><a href="/animancer/v6/docs/bugs/stabilize-feet">Stabilize Feet</a></li>
                <li><a href="/animancer/v6/docs/bugs/timeline">Timeline</a></li>
                <li><a href="/animancer/v6/docs/bugs/timing">Timing</a></li>
                <li><a href="/animancer/v6/docs/bugs/update-modes">Update Modes</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/source">Source Code</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/source/dlls">DLLs</a></li>
                <li><a href="/animancer/v6/docs/source/creating-custom-states">Creating Custom States</a></li>
                <li><a href="/animancer/v6/docs/source/graph-structure">Graph Structure</a></li>
                <li><a href="/animancer/v6/docs/source/asset-sources">Asset Sources</a></li>
                <li><a href="/animancer/v6/docs/source/coding-standard">Coding Standard</a></li>
                <li><a href="/animancer/v6/docs/source/default-script-template">Default Script Template</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/changes">Change Log</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li class="treeview">
                    <a href="/animancer/v6/docs/changes/animancer-v6-0">Animancer v6.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/changes/animancer-v6-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v6/docs/changes/animancer-v5-3">Animancer v5.3</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v5-2">Animancer v5.2</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v5-1">Animancer v5.1</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/changes/animancer-v5-0">Animancer v5.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/changes/animancer-v5-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v6/docs/changes/animancer-v4-4">Animancer v4.4</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v4-3">Animancer v4.3</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v4-2">Animancer v4.2</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v4-1">Animancer v4.1</a></li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/changes/animancer-v4-0">Animancer v4.0</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/changes/animancer-v4-0/test">Test Releases</a></li>

                    </ul>
                </li>
                <li><a href="/animancer/v6/docs/changes/animancer-v3-1">Animancer v3.1</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v3-0">Animancer v3.0</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v2-0">Animancer v2.0</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v1-3">Animancer v1.3</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v1-2">Animancer v1.2</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v1-1">Animancer v1.1</a></li>
                <li><a href="/animancer/v6/docs/changes/animancer-v1-0">Animancer v1.0</a></li>

                    </ul>
                </li>
                <li class="treeview">
                    <a href="/animancer/v6/docs/help">Help and FAQ</a> <a href="#" class="expand"></a>
                    <ul class="treeview-menu">
                        
                <li><a href="/animancer/v6/docs/help/debugging">Debugging</a></li>

                    </ul>
                </li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>01 Two Bone IK</h1>
		</section>
	<section class="content">
		<blockquote class="blockquote">
<p><strong>Difficulty</strong>: <a href="../../../introduction/glossary#example-difficulty">Intermediate</a> - Recommended after <a href="../../ik/puppet">Puppet</a></p>
<p><strong>Location</strong>: <em>Assets/Plugins/Animancer/Examples/10 Animation Jobs/01 Two Bone IK</em></p>
<p><strong>Namespace</strong>: <a href="../../../../api/Animancer.Examples.Jobs"><code>Animancer.Examples.Jobs</code></a></p>
</blockquote>
<p>This example demonstrates how the <code><a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIKJob">TwoBoneIKJob</a></code> from the <a href="https://github.com/Unity-Technologies/animation-jobs-samples">Animation Jobs Samples</a> can be used with Animancer. Unlike Unity's inbuilt <a href="../../../manual/ik">Inverse Kinematics</a> system which only works for Humanoid Rigs, this allows you to apply IK to a Generic Rig as well. This IK system could be used in a real project, however the <a href="https://docs.unity3d.com/Packages/com.unity.animation.rigging@0.3/manual/index.html">Animation Rigging</a> package contains a much better system which also uses Animation Jobs and can be used alongside Animancer without any modification.</p>
<p><img src="two-bone-ik.gif" class="img-responsive"></p>
<p><em><a href="../../../introduction/features"><strong>Pro-Only Features</strong></a> are used in this example: Animation Jobs. Animancer Lite allows you to try out these features in the Unity Editor, but they are not available in runtime builds unless you purchase <a href="/animancer/pro">Animancer Pro</a>.</em></p>
<h1 id="scripts">Scripts</h1>
<p>This example uses two scripts:</p>
<ol>
<li><details><summary>The job itself is a <code>struct</code> which implements the <a href="https://docs.unity3d.com/ScriptReference/Animations.IAnimationJob.html">IAnimationJob</a> interface. In this case, that's the <code><a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIKJob">TwoBoneIKJob</a></code> script which was taken directly from the <a href="https://github.com/Unity-Technologies/animation-jobs-samples/blob/master/Assets/animation-jobs-samples/Runtime/AnimationJobs/TwoBoneIKJob.cs">Animation Jobs Samples</a> without any real modifications. The contents of this script will not be explained here since this example is about how to use jobs, not how to implement IK.</summary><p>
</p><pre><code class="language-cs">using UnityEngine;

#if UNITY_2019_3_OR_NEWER
using UnityEngine.Animations;
#else
using UnityEngine.Experimental.Animations;
#endif

public struct <a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIKJob">TwoBoneIKJob</a> : IAnimationJob
{
    public TransformSceneHandle effector;

    public TransformStreamHandle top;
    public TransformStreamHandle mid;
    public TransformStreamHandle low;

    public void Setup(Animator animator, Transform topX, Transform midX, Transform lowX, Transform effectorX)
    {
        top = animator.BindStreamTransform(topX);
        mid = animator.BindStreamTransform(midX);
        low = animator.BindStreamTransform(lowX);

        effector = animator.BindSceneTransform(effectorX);
    }

    public void ProcessRootMotion(AnimationStream stream)
    {
    }

    public void ProcessAnimation(AnimationStream stream)
    {
        Solve(stream, top, mid, low, effector);
    }

    /// &lt;summary&gt;
    /// Returns the angle needed between v1 and v2 so that their extremities are
    /// spaced with a specific length.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The angle between v1 and v2.&lt;/returns&gt;
    /// &lt;param name="aLen"&gt;The desired length between the extremities of v1 and v2.&lt;/param&gt;
    /// &lt;param name="v1"&gt;First triangle edge.&lt;/param&gt;
    /// &lt;param name="v2"&gt;Second triangle edge.&lt;/param&gt;
    private static float TriangleAngle(float aLen, Vector3 v1, Vector3 v2)
    {
        float aLen1 = v1.magnitude;
        float aLen2 = v2.magnitude;
        float c = Mathf.Clamp((aLen1 * aLen1 + aLen2 * aLen2 - aLen * aLen) / (aLen1 * aLen2) / 2.0f, -1.0f, 1.0f);
        return Mathf.Acos(c);
    }

    private static void Solve(AnimationStream stream, TransformStreamHandle topHandle, TransformStreamHandle midHandle,TransformStreamHandle lowHandle, TransformSceneHandle effectorHandle)
    {
        Quaternion aRotation = topHandle.GetRotation(stream);
        Quaternion bRotation = midHandle.GetRotation(stream);
        Quaternion eRotation = effectorHandle.GetRotation(stream);

        Vector3 aPosition = topHandle.GetPosition(stream);
        Vector3 bPosition = midHandle.GetPosition(stream);
        Vector3 cPosition = lowHandle.GetPosition(stream);
        Vector3 ePosition = effectorHandle.GetPosition(stream);

        Vector3 ab = bPosition - aPosition;
        Vector3 bc = cPosition - bPosition;
        Vector3 ac = cPosition - aPosition;
        Vector3 ae = ePosition - aPosition;

        float abcAngle = TriangleAngle(ac.magnitude, ab, bc);
        float abeAngle = TriangleAngle(ae.magnitude, ab, bc);
        float angle = (abcAngle - abeAngle) * Mathf.Rad2Deg;
        Vector3 axis = Vector3.Cross(ab, bc).normalized;

        Quaternion fromToRotation = Quaternion.AngleAxis(angle, axis);

        Quaternion worldQ = fromToRotation * bRotation;
        midHandle.SetRotation(stream, worldQ);

        cPosition = lowHandle.GetPosition(stream);
        ac = cPosition - aPosition;
        Quaternion fromTo = Quaternion.FromToRotation(ac, ae);
        topHandle.SetRotation(stream, fromTo * aRotation);

        lowHandle.SetRotation(stream, eRotation);
    }
}
</code></pre>
<p></p></details></li>
<li><details><summary>Another script which creates the job and manages access to it. In this case, that's the <code><a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIK">TwoBoneIK</a></code> script which is a modified version of the sample <a href="https://github.com/Unity-Technologies/animation-jobs-samples/blob/master/Assets/animation-jobs-samples/Samples/Scripts/TwoBoneIK/TwoBoneIK.cs">TwoBoneIK</a> script which has been adapted for use with Animancer:</summary><p>
</p><pre><code class="language-cs">using UnityEngine;

public class <a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIK">TwoBoneIK</a> : MonoBehaviour
{
    [SerializeField] private <a href="/animancer/v6/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;
    [SerializeField] private Transform _EndBone;
    [SerializeField] private Transform _Target;

    private void Awake()
    {
        var midBone = _EndBone.parent;
        var topBone = midBone.parent;

        var twoBoneIKJob = new TwoBoneIKJob();
        twoBoneIKJob.Setup(_Animancer.Animator, topBone, midBone, _EndBone, _Target);

        _Animancer.Playable.InsertOutputJob(twoBoneIKJob);
    }
}
</code></pre>
<p></p></details></li>
</ol>
<h1 id="responsibilities">Responsibilities</h1>
<p>Since the original <a href="https://github.com/Unity-Technologies/animation-jobs-samples/blob/master/Assets/animation-jobs-samples/Samples/Scripts/TwoBoneIK/TwoBoneIK.cs">TwoBoneIK</a> script was just a sample, it contained a variety of responsibilities which would not need to be squeezed into a single script in a real system like Animancer. The following table compares the differences between the original and the <code><a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIK">TwoBoneIK</a></code> script used in this example:</p>
<table class="table">
<thead>
<tr>
<th>Original</th>
<th>Animancer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Loads an <code>AnimationClip</code> from a hard coded resource path.</td>
<td>Uses a <code><a href="/animancer/v6/api/Animancer/NamedAnimancerComponent">NamedAnimancerComponent</a></code> so the animation can be assigned in the Inspector.</td>
</tr>
<tr>
<td>Returns early if any of the references are <code>null</code> to avoid causing exceptions.</td>
<td>The script serves no purpose if the references are <code>null</code> so it's better to cause exceptions instead of having it silently fail to work.</td>
</tr>
<tr>
<td>Creates a sphere in the script which can be moved around using the scene gizmos to determine the IK target.</td>
<td>Uses a serialized field to reference a target object since there is no point in hard-coding it in the script and uses the <code><a href="/animancer/v6/api/Animancer.Examples.InverseKinematics/MouseDrag">MouseDrag</a></code> script from the <a href="../../ik/puppet">Puppet</a> example to allow the target to be dragged around in the Game view.</td>
</tr>
<tr>
<td>Creates a <code>PlayableGraph</code> to play the animation and manually destroys it in <code>OnDisable</code>.</td>
<td>The job is inserted into Animancer's existing graph.</td>
</tr>
<tr>
<td>Creates a <code>AnimationScriptPlayable</code> to run the <code><a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIKJob">TwoBoneIKJob</a></code> and connects it to the <code>AnimationClipPlayable</code> of the animation and the graph output.</td>
<td>Uses <code>AnimancerPlayable.InsertOutputJob</code> to have animancer do all that internally.</td>
</tr>
</tbody>
</table>
<h1 id="fields">Fields</h1>
<table class="table">
  <thead>
    <tr><th style="width:50%">Code</th>
    <th style="width:50%">Inspector</th>
  </tr></thead>
  <tbody>
    <tr>
      <td>
<p>While the reduced complexity from the original script is nice, the most important improvement is actually the fact that the job gets inserted into the <code>PlayableGraph</code> managed by Animancer. The original had the script create its own graph to play its own animation which meant that only one instance could actually be used per character to apply IK to one limb, but by inserting the job into an existing graph we have made it possible to use multiple instances of the script to apply IK to multiple limbs.</p>
<pre><code class="language-cs">[SerializeField]
private <a href="/animancer/v6/api/Animancer/AnimancerComponent">AnimancerComponent</a> _Animancer;

[SerializeField]
private Transform _EndBone;

[SerializeField]
private Transform _Target;
</code></pre>
</td>
      <td><img src="inspector.png" class="img-responsive"></td>
    </tr>
  </tbody>
</table>
<h1 id="initialisation">Initialisation</h1>
<p>The first thing we need to do is get the bones we want to apply the IK to, simply using the parent of the <code>_EndBone</code> we assigned in the Inspector (<code>midBone</code>) and the parent of that bone (<code>topBone</code>):</p>
<pre><code class="language-cs">private void Awake()
{
    var midBone = _EndBone.parent;
    var topBone = midBone.parent;
</code></pre>
<p>Then we create the <code><a href="/animancer/v6/api/Animancer.Examples.Jobs/TwoBoneIKJob">TwoBoneIKJob</a></code> and call its <code>Setup</code> method to specify the <code>Animator</code>, bones, and target object:</p>
<pre><code class="language-cs">    var twoBoneIKJob = new TwoBoneIKJob();
    twoBoneIKJob.Setup(_Animancer.Animator, topBone, midBone, _EndBone, _Target);
</code></pre>
<p>And finally, we call <code>AnimancerPlayable.InsertOutputJob</code> to insert it in Animancer's <code>PlayableGraph</code> between the finaly output and whatever playable was previously connected to the output:</p>
<pre><code class="language-cs">    _Animancer.Playable.InsertOutputJob(twoBoneIKJob);
}
</code></pre>
<p>After that, Animancer will still be able to play animations and do everything else normally, except that every frame before the animations are applied to the model the <code>TwoBoneIKJob.ProcessAnimation</code> will be executed (once for each of the 4 instances we set up to control the 4 legs of the <em>SpiderBot</em>). That method does some math in order to determine how it needs to rotate the <code>midBone</code> and <code>topBone</code> in order to bring the position of the <code>_EndBone</code> as close to the position of the <code>_Target</code> as possible.</p>
<h1 id="conclusion">Conclusion</h1>
<p>As noted earlier, this IK system could be used in a real project, however the <a href="https://docs.unity3d.com/Packages/com.unity.animation.rigging@0.3/manual/index.html">Animation Rigging</a> package contains a much better system which also uses Animation Jobs and can be used alongside Animancer without any modification.</p>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                <strong><div style="text-align:left; display:flex">

<div>
<p>Documentation</p>
<p><a href="/animancer/docs/examples">Examples</a></p>
<p><a href="/animancer/docs/manual">User Manual</a></p>
<p><a href="/animancer/docs/changes">Change Log</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Download</p>
<p><a href="https://kybernetik.itch.io/animancer-pro">Itch.io (Recommended)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-pro-116514?aid=1100l8ah5">Asset Store (Animancer Pro)</a></p>
<p><a href="https://assetstore.unity.com/packages/tools/animation/animancer-lite-116516?aid=1100l8ah5">Asset Store (Animancer Lite)</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Contact</p>
<p><a href="https://github.com/KybernetikGames/animancer/issues">Github Issues</a></p>
<p><a href="/animancer/forum">Unity Forum</a></p>
<p><a href="mailto:animancer@kybernetik.com.au?subject=Animancer">Email</a></p>
</div>

<div style="width:10%"></div>

<div>
<p>Other Assets</p>
<p><a href="/inspector-gadgets">Inspector Gadgets</a></p>
<p><a href="/weaver">Weaver</a></p>
<p><a href="/ultevents">UltEvents</a></p>
</div>

</div></strong>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).ready(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        useMaxWidth: false
                    },
					startOnLoad: false,
					cloneCssStyles: false
                });     
                mermaid.init(undefined, ".mermaid");

                // Remove the max-width setting that Mermaid sets
                var mermaidSvg = $('.mermaid svg');
                mermaidSvg.addClass('img-responsive');
                mermaidSvg.css('max-width', '');

                // Make it scrollable
				var target = document.querySelector(".mermaid svg");
				if(target !== null)
				{
					var panZoom = window.panZoom = svgPanZoom(target, {
						zoomEnabled: true,
						controlIconsEnabled: true,
						fit: true,
						center: true,
                        maxZoom: 20,
                        zoomScaleSensitivity: 0.6
					});			                          

                    // Do the reset once right away to fit the diagram
                    panZoom.resize();
                    panZoom.fit();
                    panZoom.center();
                    
                    $(window).resize(function(){
                        panZoom.resize();
                        panZoom.fit();
                        panZoom.center();
                    });
				}
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });

            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    
</body></html>